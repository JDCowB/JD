/*
活动名称：店铺刮刮乐
活动链接：https://shop.m.jd.com/shop/lottery?shopId=<店铺id>&venderId=<店主id>
环境变量：jd_shopLottery_activityUrl // 活动链接
        jd_shopLottery_Notify // 是否推送通知（true/false），默认不推送

注：活动链接变量只提供店主id即可，但访问活动需要同时包含店铺id和店主id

*/

const $ = new Env('店铺刮刮乐')
const jdCookie = require('./jdCookie')
const common = require('./function/jdCommon')
const notify = require('./function/sendJDNotify')
const getSign = require('./function/getSign')

var version_='jsjiami.com.v7';const lillI1II=iIl1I11l;function i1IiI1(){const i1Ii11iI=(function(){return[...[version_,'lEEjEbGsfXjiamFrUiV.QScRxgoKmIA.HMEvGbL7==','WOdcQCoh','5lMj5lQw5PYS5yQ95zUy6l6W5zI756U25PA35O2I','W5FcU8o3ddxdPW','WR45W5udWO8','g2JdUrzT','BCkyfY0WW53cHa','W4iNhH5I','44cY5O+I56AI44gx6k285yA36i+65y+IBxvGW4X4aa','zmode8oNW6XqW68','bCo4ExOPW5tcGSkVWQubWORcSq','W4D0kSk7W7GykSo/','FmkGCKjJW5f1WOucnSkrW4aNgdv8','rxpdJaxdPW','FCk1WQxcRgC','WPe0oSkdW4S','W6ldQd/dOG3dQHRdR8kfne9QCdbX','mSoMW47cSCk0W6Grk0NdR2C','WRjHW5pdNmoKuSoOW53cMSoipq','W4/cMmk7BZi','fxNdPMPL','WPKxxmo2WRf6arm','WQVcUddcPWu','WR/cUIZcObtcMW','W6PSWRFdItRdRa4','FSoghSoYW4y','W5Her8oeWOy','k8knCJZcJq','W7hcI2e','ECk6WRNcPa','W5ldHNXYrG','xmkpWQxcTwC','W5tdIKf4','xSkTmW18','W77cJh1sWPW','omoHW7ZdQctcJN7cRNNcI3PLjW','W5ZcT8oOcZhdSHG','W6xdIrJdPXq','ymk7WRZcGga','bCkPsZtcMq','W5rvdCk4W6u','W5FdRb3dNWO','WRTpW5pdH8oW','W6ZcN8kzEc3cUSoe','WRKdW7S','8lUUJM8','WQLHAG','W6xdUchcIXdcUSobiq','WOBcHmkckmke','WRfHAZZdVq','W6/cImkQzclcVmoAzSkQn8kuitNdNConqmo+W5S/WPJdTmodWQjaxSkl','WQfbWQNcKwq','ECojf8oY','ESo6WPVcGSkgagtcH0iggG','fSkRW49PWQeOuwlcOSozWQOGW4W','zSkuha','WQBdKhb2WRBdRLhcTW','BNRdH0zE','W4i7fZJcVG','f8k4WQ0gW5G','jmkSWPGHW5O','W4jiFCouWOK','mxhdK2bM','5Rsp5yMN5ysV5y6S77Ya','DK0fW6NdVa','W4/cNdfRWRa','W5BdS8kilmkTW5FdH8kFWQxcKLi','WRPAW6JdSCov','tSoSWQO4W7jX','FCkwWPlcJ2K','bNVdPY9K','uX3dGW','bCkCW5xdGmoH','CSo9WQ8KW7m','u8kMrXbt','W7SaeHNcGq','omkZoSk2F8k5hW','5lIP5lUW5P+45yQ25zII6lYh5zM056Mq5PA15OYT','W5hcVmkYwqW','s8kJstjm','jN5V','E0VcPmoKCCk/qSkirHW','p33dNaj4','q8kfWPy','WPBcIWqOj8kgoCkbwGvNWR4','BSkQyuvuW5T1WPuHlCkj','WRmfW6q','WPBcRSowDa','WOD3WQRcQKddI8oAkszRhL9hb8kq','WQjso09S','WRy3W4lcPSo/W5iJqCkqW6BcGvG','WQZcVbBcSqNcKa','WOhdPKHxW7W','WO4naCkfW4u','bCovWPJdSmor','E8ohhCosW4Xx','pmoWlCkfW70','WPJdTtlcRCku','zSkucJ89W5BcMa','ze0zW6ZdOCkYW5nqBCktEwnEW7/dKmkQd8kEW67dVv3dOCoNW5JcH8kqW4Hqb3/dGCkBnW','BLGmW7dcPCkWW55nCSkz','m1LQW4tdIq','WPBdO0zYW6ibWPldRCk1Aa','W4VcOCkfrI4','WRVdLqFcICku','WODJW7pdNmoN','gSkmmCkovW','BNPeW4hcN8kP','euBdQ1LF','n8kzimkaCG','f8oDpW'],...(function(){return[...['W4PPF8oDWO13j2qdDSkC','5lUM5lIn5PYf5yIs5zUq6lYE5zUo56Mp5PAA5OY4','WOLHWO3cLLxdIq','CmopkSoqW7C','DCkaed9+','k1JdHxr/','zCk6WQ0','smkpWOu','yMddK3Ld','WOvnW4NdSSoC','W5ldJNPxwq','gCkczG','aMFdUab6W6a','WPdcG8kBlSk8WP8E','B8klvdv3','DCkCpsfm','hgtdSXXR','E8ohhq','n1pdIhn2','W7BdOMpdQ0RdLmkc','WQlcRSoWC8oY','whv4W6RcQa','4PMEFEIUUowIH+wePoAGVow9NoATL+EGPEEAUowmSUMhNq','ymknWOxcLfC','gwZdUbbKW6a','WOtcJ8kIgCkN','FSoBfSo4W5LmW68','s8oWWP4uW6DT','W5XPESoKWRi','WPxdR0XiW50','W7Pko8k7W5q','W4SlWRVcG8otBSo3','zeOiW7ldRmkvW5Dxz8koFJXsWRVdImkZ','WOX9WRK','W6NcG8ks','WR9TW4a','pNRdRHDgW7u9WRG','s8k4tcTQW5LN','W7fZWQRdIrVcO08ODCkXECk4qmolW7/dTuRdGNNdRg0Ie1eiW4RcRtSRW63dPSoTWPXkW7HAWOddRCk9eSkNuSojBGBcMq','W7rIWQ3dIGNdVGu','W6VcObfPWQq','WQ/cOYdcStlcI8oM','yCoQa8kEpG','BmksaW','WP0YiCkyW5HUjW','F0WtW5ldHa','WR4PW5JdRCoGWOG','4PIYWQtORQFLH43LR77KU43LV7hOPipNMk/NJ7hLOQJLJPZPH5ZLKzhLHPhOVzdOO4xOH6xMNjW','o35fW7ldKq','WRjgh8ka6k2b5Rc75Aw26lA/772U6k2L5Qkn5P6Z576G6lAV6yEF6k+a','W53cOCoIoH0','W63cIJr0WQRcG07cTSoeW7a0oXvSWR3dPgbtW6e','sSk3WPxdKmkk','W7VcJx4','8lobUSk756Ic5Rge','W6tcOxDfWOu','orxdSmk/emoVtmkgxXZdVHO','vmo0WPaHW4DQcW','WOldR1vFW58lWO7dPCkIwSopv8oLqa','5lUd5AE85Bs457IF5y+s5lQ36l6n5lMoAG','hCoBia','lvpdKIzK','W4xdNez5ySoEbmkizd9N','hCk6W7xdK8oc','WPpcOSoFFSo8W4pdNSky','4PQFuUITK+wHR+wfU+AGO+w/HUASN+EHR+EAJoMrVUAnNW','WRT1aL9lwmoh','W4zewmos','r8kKiZ9iWPtcLq','z8khds59WPRcHs/cMmoZh8oshGFdOmoKxq','W6XCW7qgWPBdPwXD','ASk9WPK','CNtcTmoYwq','iNhdLxbR','dq7cK3JdLMpdVWa0DmkXWOy1nSo+','WP/dUZlcGCkf','zhCWW7tdKq','j8kEWRKYW5m','ySo4k8kuha','WQ0VWOBdGmoZWPi6cmo9W4VdLurdW4q','FmksWQBcVK1X','a8ornmksW5FcMW','urVdH2/cRh7cPbK','qfJdMwX0','W7mDWQ3cGSo8Amo/ia','WQjhpgbm','W4JcN8kpxdm','WRRcQCkEcCk2','WRWCW4yCWO4','omkLlG','W5ufWQhcGmoGFmo8','W4xcVtu','W6JcICkgzcVcTmop','DmkpetS','WPpcUmk8n8kw','W59exmod','W5pcUXyKWOvsWQldPmktySo4xa','seDBW6ZcIa','yCo6gmkM','W5ZcReHEWQK','WPCHW50wWPW','W70jmbVdIuz1W5FcRxu','WPdcGCkvmmkVWOKeW6CkWRJcS8obWOtcUfGf','doodGUA3HEwiQowETowFN+obTa','lSoWWPFdICo4','W4KffZi','WO5ZWRpcMG','W5TnwSohWRXAfaRdJH7cSsjhWObmWRrDca','W5iRdc7cQa','WR1PW5tdNSoz','WPpdR094W5uwWQZdQa','8yQFPCk8'],...(function(){return['Be46W6NdR8k/','WQGsiCkRW7m','E0VcPmoK','BgVdG1fEWRPuWPlcTui','WOLSW6ldJ8ok','BKVcUW','kSoZWQhdQ8o7s3Xc','WPFdR1jPW5Wq','W4mJmINcPq','tvtdMGZdKW','vmk8qG','WQtcIJhcJqG','WOvjW7/dNCo2','WP9EqgqnA0ZcO0BdGCoRWR4','WRddKhzqW5i','WRXKW6xdV8ok','WPrAW7hdG8klmmoWdCo/hSo2ba','pmkLjCkQECk3fa','WRP4WOZcS3e','WRldHqddJoIUK+AZHUwKHEI2P+++P+IUQEAJQ+AEOEE9GUI2SoMhKEITLq','W4zorSoCWQG','WOyVjCkNW5G','WRznyXZdPq','fv3cJG','u3JdU1P5','WQryy1pdLXzqW47cSfGzW6i','q2ZcRSo8ra','omkTuCkzlCkdWQr2WRm','W5megdhcIG','W6/dRCkBmmkZWPVcVEw/VowKV+odPUs6V+s6L+I0G+wnSq','kSo7WQ/dPq','W4mcWRJcHSoy','Bh5hW4m','WRWcW7GPWP4','W75Oka','W7nZWQRdSZi','ASkbqJfB','WOjNtaFdRW','W4mpWOVcSCow','6lsG5yYL5PsE5PEi','s8k8WOJcON0','WRhcRtRcSGhcMCoT','WRVdVtVcQ8kH','fSoTf8klW4W','WRa9W4ldUmk+W5WTqmoyW6NcJ0eBW5NdNJXQ','W7pcHCoJdse','b8kzDbxcMW','z8kGWPhcVLi','WQVcV8olDCob','iMv8W4pdI8oWpXRcMJPIF8krWO/cGc0JW6ddUbpdTCk+WPBcJ3znW6jeb2BcQrRcOhixtmosy8kdWPpcMSkV','eSoBi8kc','fSkfBtVcJmo7','z8oKECkjzSksch00','W75IWQRdQGhdVG5oESkNFW','BfmAW6xdUSkL','zmo+dmkW','F8oolSk+ea','o8kRW5hdGCoEeG','s8oWWP4','W4tcSYi','W4BcV8oJatm','y2hdRYJdNq','smkYvYHD','ze3cPa','WRr2WOJcJ2O','5lU15AwB5Bww5y+g5lUS6l+y','W5lcVCo1hJNdSG','pmk+W4BdLCoga3FcI30wpGhdMG','y8kMCMLqW4a','AmkmWRxdM8kR','5lQy5As55Bwv5y+b5lIa6l61','W41Dxmod','tXpdLNFcH0RcUXa','qCkYWQ3cPvG','a8ohemk0W7e','WQq3W4FdOCoM','5lQo5AAZ5BsW57Mp5y235lIK6l+w5lQHpa','eSkoBs3cN8oOwq','ASkXWRJdMmkJ','xmkMWQ/cOL7dMcFcRq','ywRdQg9tWQzxWR/cVvpdKK1iW40rnM7cU38hAa','6lEg5y+L5Ps+5PA3','W4Xjxmo8WQ8','hCkTWR0IW6pcJ34','aL9LW5ZdLq','4PILW4ZORilLOBZLH5pMO6/LVQxMRyNNOQVNM4FPKj7MJ6e','pHpdTmkYfSoSCSkbybBdNZ8','5lM/5lIE5P6Q5yIu5zU66l+V5zMc56UE5PA/5O+u','WOZdUxz1W54','o8krWOO1W6O','WRGjW68/WOFdHKa','i8o/WQZdLCo0','WPldIaNcTCkLsLa/a3OQ','k8oXaSkpW40','W4CfWQ3cLmo6','e8keEq','W7BdP2m','b8k2W5JdM8oQ','ySkZWRNcU2O','b8k2W4NdUSoc','ggldOHvAW6e+','WQyfW7SIWQ/dJ0nz','sSkjkIyP','W4efhG','WQj6W4/dTSo0','b2BdRa','A8kAWQpcLxW','W6TrumoIWRK','W6ajoW/cGvvqW5O','W7q8WQ/cMSor'];}())];}())];}());i1IiI1=function(){return i1Ii11iI;};return i1IiI1();};(function(lli1IlIl,ilI11lIl,ii1il1i1,lllii1Ii,IilIilII,Il11li1l,Illi11i1){return lli1IlIl=lli1IlIl>>0x7,Il11li1l='hs',Illi11i1='hs',function(lil1lIII,iIlll1I1,I1lIII1i,lIi1IiiI,IliI1i11){const l1lI11II=iIl1I11l;lIi1IiiI='tfi',Il11li1l=lIi1IiiI+Il11li1l,IliI1i11='up',Illi11i1+=IliI1i11,Il11li1l=I1lIII1i(Il11li1l),Illi11i1=I1lIII1i(Illi11i1),I1lIII1i=0x0;const Il1lli=lil1lIII();while(!![]&&--lllii1Ii+iIlll1I1){try{lIi1IiiI=parseInt(l1lI11II(0x19e,'bAIB'))/0x1+parseInt(l1lI11II(0x203,'Hp[['))/0x2+-parseInt(l1lI11II(0x221,'iKcc'))/0x3*(-parseInt(l1lI11II(0x234,'nQ9b'))/0x4)+parseInt(l1lI11II(0x14d,'9ifD'))/0x5*(-parseInt(l1lI11II(0x22a,'I^kH'))/0x6)+parseInt(l1lI11II(0x215,'r!@Q'))/0x7+parseInt(l1lI11II(0x175,'$IBB'))/0x8+parseInt(l1lI11II(0x192,'eicZ'))/0x9*(-parseInt(l1lI11II(0x1a0,'gJdT'))/0xa);}catch(IlllIII1){lIi1IiiI=I1lIII1i;}finally{IliI1i11=Il1lli[Il11li1l]();if(lli1IlIl<=lllii1Ii)I1lIII1i?IilIilII?lIi1IiiI=IliI1i11:IilIilII=IliI1i11:I1lIII1i=IliI1i11;else{if(I1lIII1i==IilIilII['replace'](/[UlfAHrKxLISbRQEFMGXgV=]/g,'')){if(lIi1IiiI===iIlll1I1){Il1lli['un'+Il11li1l](IliI1i11);break;}Il1lli[Illi11i1](IliI1i11);}}}}}(ii1il1i1,ilI11lIl,function(lllIi1l1,Ii1l1I1,iIlill1,li1llI1i,lI1iiI,iilIi1iI,lIIlIIii){return Ii1l1I1='\x73\x70\x6c\x69\x74',lllIi1l1=arguments[0x0],lllIi1l1=lllIi1l1[Ii1l1I1](''),iIlill1=`\x72\x65\x76\x65\x72\x73\x65`,lllIi1l1=lllIi1l1[iIlill1]('\x76'),li1llI1i=`\x6a\x6f\x69\x6e`,(0x13b0e7,lllIi1l1[li1llI1i](''));});}(0x6400,0x21f10,i1IiI1,0xca),i1IiI1)&&(version_=i1IiI1);const activityUrl=process[lillI1II(0x1f3,'nQ9b')][lillI1II(0x224,'14OZ')]||'',isNotify=process[lillI1II(0x1f3,'nQ9b')][lillI1II(0x1d5,'Zum7')]===lillI1II(0x172,'Z2!O');let cookie='';const cookiesArr=Object[lillI1II(0x177,'gJdT')](jdCookie)[lillI1II(0x1c0,'hQFw')](l1II1ll1=>jdCookie[l1II1ll1])[lillI1II(0x1f5,'L]Nw')](I111Illl=>I111Illl);function iIl1I11l(_0x1f2b97,_0x2efa4c){const _0x2a52a7=i1IiI1();return iIl1I11l=function(_0x18000e,_0x5c29a9){_0x18000e=_0x18000e-0x116;let _0x5d1f31=_0x2a52a7[_0x18000e];if(iIl1I11l['IceSkp']===undefined){var _0x206207=function(_0x507960){const _0x528d5a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x6476fc='',_0xab67ae='';for(let _0x17653d=0x0,_0x25de25,_0x41c2b1,_0x5a978f=0x0;_0x41c2b1=_0x507960['charAt'](_0x5a978f++);~_0x41c2b1&&(_0x25de25=_0x17653d%0x4?_0x25de25*0x40+_0x41c2b1:_0x41c2b1,_0x17653d++%0x4)?_0x6476fc+=String['fromCharCode'](0xff&_0x25de25>>(-0x2*_0x17653d&0x6)):0x0){_0x41c2b1=_0x528d5a['indexOf'](_0x41c2b1);}for(let _0x105f52=0x0,_0xa3ba70=_0x6476fc['length'];_0x105f52<_0xa3ba70;_0x105f52++){_0xab67ae+='%'+('00'+_0x6476fc['charCodeAt'](_0x105f52)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xab67ae);};const _0x550b08=function(_0x4df928,_0x5014aa){let _0x14afc3=[],_0x298372=0x0,_0x2e1797,_0x4c6da3='';_0x4df928=_0x206207(_0x4df928);let _0x4e8dad;for(_0x4e8dad=0x0;_0x4e8dad<0x100;_0x4e8dad++){_0x14afc3[_0x4e8dad]=_0x4e8dad;}for(_0x4e8dad=0x0;_0x4e8dad<0x100;_0x4e8dad++){_0x298372=(_0x298372+_0x14afc3[_0x4e8dad]+_0x5014aa['charCodeAt'](_0x4e8dad%_0x5014aa['length']))%0x100,_0x2e1797=_0x14afc3[_0x4e8dad],_0x14afc3[_0x4e8dad]=_0x14afc3[_0x298372],_0x14afc3[_0x298372]=_0x2e1797;}_0x4e8dad=0x0,_0x298372=0x0;for(let _0x1d02c0=0x0;_0x1d02c0<_0x4df928['length'];_0x1d02c0++){_0x4e8dad=(_0x4e8dad+0x1)%0x100,_0x298372=(_0x298372+_0x14afc3[_0x4e8dad])%0x100,_0x2e1797=_0x14afc3[_0x4e8dad],_0x14afc3[_0x4e8dad]=_0x14afc3[_0x298372],_0x14afc3[_0x298372]=_0x2e1797,_0x4c6da3+=String['fromCharCode'](_0x4df928['charCodeAt'](_0x1d02c0)^_0x14afc3[(_0x14afc3[_0x4e8dad]+_0x14afc3[_0x298372])%0x100]);}return _0x4c6da3;};iIl1I11l['hYhgMV']=_0x550b08,_0x1f2b97=arguments,iIl1I11l['IceSkp']=!![];}const _0x6274b2=_0x2a52a7[0x0],_0x16bd4f=_0x18000e+_0x6274b2,_0x26f6e7=_0x1f2b97[_0x16bd4f];return!_0x26f6e7?(iIl1I11l['mRBtCY']===undefined&&(iIl1I11l['mRBtCY']=!![]),_0x5d1f31=iIl1I11l['hYhgMV'](_0x5d1f31,_0x5c29a9),_0x1f2b97[_0x16bd4f]=_0x5d1f31):_0x5d1f31=_0x26f6e7,_0x5d1f31;},iIl1I11l(_0x1f2b97,_0x2efa4c);}!cookiesArr[0x0]&&($[lillI1II(0x16e,'WaCG')]($[lillI1II(0x17f,']$Fw')],lillI1II(0x1fa,'OaB3')),process[lillI1II(0x1cc,'a2KJ')](0x1));!(async()=>{const IIliIIl=lillI1II,iliIiIll={'pemTm':function(iIlIIl1,llli111I){return iIlIIl1===llli111I;},'sCnra':IIliIIl(0x1ac,'Hp[['),'tWMLf':IIliIIl(0x150,'r!@Q'),'KYDdh':IIliIIl(0x1cb,'&f)j'),'EhMZn':function(iiiiliiI){return iiiiliiI();},'XvLFB':function(I11iIlIl,IlillIi1){return I11iIlIl===IlillIi1;},'ggPGI':IIliIIl(0x1ab,'PE&K'),'CteUZ':IIliIIl(0x144,'umhe'),'wpyfe':IIliIIl(0x1da,'14OZ'),'BMAZz':IIliIIl(0x155,'nQ9b'),'KNQiM':IIliIIl(0x12b,'av8y'),'nLiKA':function(li1ll11I,i11ilIi){return li1ll11I<i11ilIi;},'OZxKI':function(iil11ilI,ii1l1Ill){return iil11ilI!==ii1l1Ill;},'mXOKX':IIliIIl(0x16b,'14OZ'),'YAlWX':IIliIIl(0x161,'k]QK'),'gATCl':IIliIIl(0x15f,'Sz2m'),'BWxuq':function(i1iilIll,IIliil){return i1iilIll+IIliil;},'fNcXL':function(iiIi11II,IlIiiii){return iiIi11II(IlIiiii);},'akedH':IIliIIl(0x24d,'iKcc'),'gYPlw':function(ll11I11I,llIiIll){return ll11I11I===llIiIll;},'hMtrb':IIliIIl(0x237,'TW2('),'tLOSQ':function(IIiII11,lIlIilll){return IIiII11+lIlIilll;}};if(!activityUrl){if(iliIiIll[IIliIIl(0x19d,'Zum7')](iliIiIll[IIliIIl(0x118,'YS(^')],iliIiIll[IIliIIl(0x12e,'ZcgM')])){console[IIliIIl(0x170,'hQFw')](iliIiIll[IIliIIl(0x1f0,'a2KJ')]);return;}else try{III1iiIi=iIll1II1[IIliIIl(0x1f7,'pdk5')](llilllii),iliIiIll[IIliIIl(0x132,'$IBB')](li1IiIIi[IIliIIl(0x21d,'14OZ')],'0')&&(I1iIillI[IIliIIl(0x1c4,'9ifD')](iliIiIll[IIliIIl(0x19b,'866c')]),IiIiiI11[IIliIIl(0x1df,'BAQ6')][IIliIIl(0x18a,'9ifD')](iliIiIll[IIliIIl(0x14c,'I^kH')]),Ii1llill[IIliIIl(0x16f,'PE&K')]=!![]);}catch{li11I1I[IIliIIl(0x21e,'BAQ6')](IIliIIl(0x116,'Eagh')),iIiI1i1[IIliIIl(0x20a,'H%sJ')]=!![];}}const IilI1iII=common[IIliIIl(0x1cd,'Sz2m')](activityUrl);if(!IilI1iII){console[IIliIIl(0x242,'Eagh')](iliIiIll[IIliIIl(0x208,'iKcc')]);return;}$[IIliIIl(0x247,'$7wY')]=activityUrl,$[IIliIIl(0x183,'$IBB')]=common[IIliIIl(0x24a,']$Fw')](activityUrl,iliIiIll[IIliIIl(0x179,'BAQ6')]);if(!$[IIliIIl(0x155,'nQ9b')]){console[IIliIIl(0x220,'866c')](iliIiIll[IIliIIl(0x178,'I^kH')]);return;}notify[IIliIIl(0x1c7,'L]Nw')]({'title':$[IIliIIl(0x1bc,'gJdT')]}),console[IIliIIl(0x14a,'I^kH')](IIliIIl(0x231,'(Qk2')+$[IIliIIl(0x204,'bYsF')]);for(let I1IiIIiI=0x0;iliIiIll[IIliIIl(0x218,'TW2(')](I1IiIIiI,cookiesArr[IIliIIl(0x25d,'6B*z')]);I1IiIIiI++){if(iliIiIll[IIliIIl(0x25c,'WaCG')](iliIiIll[IIliIIl(0x253,'F^)H')],iliIiIll[IIliIIl(0x16c,'ZcgM')])){const iiIlIIlI=iliIiIll[IIliIIl(0x1ff,'OaB3')][IIliIIl(0x1d0,'QhFM')]('|');let liIII1Il=0x0;while(!![]){switch(iiIlIIlI[liIII1Il++]){case'0':console[IIliIIl(0x137,'14OZ')](IIliIIl(0x1a2,'nQ9b')+$[IIliIIl(0x11d,'Zum7')]+'】'+($[IIliIIl(0x18b,'iDlN')]||$[IIliIIl(0x1fd,'Ezk&')])+IIliIIl(0x128,'iKcc'));continue;case'1':$[IIliIIl(0x167,'Sz2m')]='';continue;case'2':$[IIliIIl(0x20b,'YS(^')]=iliIiIll[IIliIIl(0x1b2,'L]Nw')](I1IiIIiI,0x1);continue;case'3':await iliIiIll[IIliIIl(0x1a1,'bAIB')](Main);continue;case'4':$[IIliIIl(0x139,'pdk5')]=iliIiIll[IIliIIl(0x233,'hQFw')](decodeURIComponent,common[IIliIIl(0x14f,'$IBB')](cookie,iliIiIll[IIliIIl(0x1e3,'PE&K')]));continue;case'5':$[IIliIIl(0x171,'14OZ')]=notify[IIliIIl(0x209,'iKcc')]($[IIliIIl(0x214,'I^kH')],$[IIliIIl(0x169,'PE&K')]);continue;case'6':$['UA']=common[IIliIIl(0x1e0,'iDlN')]($[IIliIIl(0x1d4,'r!@Q')]);continue;case'7':cookie=cookiesArr[I1IiIIiI];continue;}break;}}else I111II1i[IIliIIl(0x18f,'0g45')](iliIiIll[IIliIIl(0x16a,'iT4v')]),lIliIIli[IIliIIl(0x134,'PE&K')][IIliIIl(0x260,')f#P')](iliIiIll[IIliIIl(0x1de,'qhkn')]);}isNotify&&notify[IIliIIl(0x188,'Zum7')]()&&(iliIiIll[IIliIIl(0x1b0,')f#P')](iliIiIll[IIliIIl(0x133,'Ezk&')],iliIiIll[IIliIIl(0x21c,'bYsF')])?(notify[IIliIIl(0x1c8,'J(QT')](iliIiIll[IIliIIl(0x131,'a2KJ')](notify[IIliIIl(0x141,'av8y')],IIliIIl(0x17c,'Hp[[')+$[IIliIIl(0x153,'GR6N')])),await notify[IIliIIl(0x212,'GR6N')]()):iliIiIll[IIliIIl(0x21b,'umhe')](Iii1il1i));})()[lillI1II(0x230,'&f)j')](l1IlI111=>console[lillI1II(0x1c9,'$7wY')](l1IlI111))[lillI1II(0x254,'Z2!O')](()=>$[lillI1II(0x17e,'eicZ')]());async function Main(){const IIIi111=lillI1II,il1Ii1iI={'zBUjg':function(liiiii11){return liiiii11();},'ZjRLC':function(iIiIl111,i1i1111){return iIiIl111(i1i1111);},'JXqJc':IIIi111(0x1ba,'H%sJ'),'GiAik':function(i1Iiil1i,I111I1Ii){return i1Iiil1i===I111I1Ii;},'jbyBf':function(Ilil1IIl,lIiI11I){return Ilil1IIl!==lIiI11I;},'kubKk':IIIi111(0x127,'&f)j'),'zqzRL':IIIi111(0x17b,'ZcgM'),'RRgjc':IIIi111(0x160,'F^)H'),'iWDus':IIIi111(0x1d1,'iDlN'),'xBxLh':IIIi111(0x1c6,'Sz2m'),'HNmom':function(lIIiI11i,il1111I1){return lIIiI11i(il1111I1);},'jjUIM':IIIi111(0x249,'nQ9b')};$[IIIi111(0x13a,'0g45')]=![],await il1Ii1iI[IIIi111(0x219,'s*)p')](getLoginStatus);if($[IIIi111(0x14e,'fatV')])return;await il1Ii1iI[IIIi111(0x197,']$Fw')](sendRequest,il1Ii1iI[IIIi111(0x176,'6B*z')]);if(il1Ii1iI[IIIi111(0x129,'nQ9b')]($[IIIi111(0x1a6,'BAQ6')],0x1)){if(il1Ii1iI[IIIi111(0x213,'(Qk2')](il1Ii1iI[IIIi111(0x23c,'0g45')],il1Ii1iI[IIIi111(0x13f,'gJdT')])){const liiiIIll=iIIllI1I[IIIi111(0x18c,'$IBB')][IIIi111(0x243,'9ifD')][IIIi111(0x226,'YS(^')]||'';I1l1Ilii[IIIi111(0x220,'866c')](IIIi111(0x21f,'Ezk&')+liiiIIll[IIIi111(0x232,'k]QK')]('：')[0x1]),l1llI11[IIIi111(0x13c,'H%sJ')][IIIi111(0x1b8,'s*)p')](liiiIIll);}else await il1Ii1iI[IIIi111(0x12a,'6B*z')](sendRequest,il1Ii1iI[IIIi111(0x142,'k]QK')]);}il1Ii1iI[IIIi111(0x1aa,'866c')]($[IIIi111(0x185,'k]QK')],0x2)?il1Ii1iI[IIIi111(0x206,'&f)j')](il1Ii1iI[IIIi111(0x1f2,'PE&K')],il1Ii1iI[IIIi111(0x1a9,'0g45')])?(console[IIIi111(0x242,'Eagh')](il1Ii1iI[IIIi111(0x1b4,'TW2(')]),$[IIIi111(0x23e,'WaCG')][IIIi111(0x229,'Z2!O')](il1Ii1iI[IIIi111(0x190,'iKcc')])):IiIiiI1I[IIIi111(0x21e,'BAQ6')](liI1iiii):(await il1Ii1iI[IIIi111(0x1d9,'Eagh')](sendRequest,il1Ii1iI[IIIi111(0x17d,'iDlN')]),await $[IIIi111(0x174,'a2KJ')](0x1f4));}async function sendRequest(IiIlIi11){const iII1ll1l=lillI1II,Ilil1ii1={'dliKL':function(I1li111i,i11lll){return I1li111i(i11lll);},'NxkNp':function(IlI1il,IililI1l){return IlI1il!==IililI1l;},'DGYEL':iII1ll1l(0x22f,'a2KJ'),'NPFMm':iII1ll1l(0x193,'$IBB'),'CVLZQ':function(iiliiIli,llIIilI1){return iiliiIli(llIIilI1);},'JtNxx':function(l1Ilill,I1IiilII){return l1Ilill===I1IiilII;},'ofBJX':iII1ll1l(0x1e1,'F^)H'),'wmxyc':iII1ll1l(0x1fe,'$7wY'),'elpvj':iII1ll1l(0x1e7,'r!@Q'),'TdVpX':iII1ll1l(0x187,'9ifD'),'uQOkE':iII1ll1l(0x14b,'L]Nw'),'LRwtS':function(IillliI,Il1lII){return IillliI===Il1lII;},'TtWgp':iII1ll1l(0x11f,'GR6N'),'mrlJl':function(Il1iIlII,lI1llli,IIIIIil1){return Il1iIlII(lI1llli,IIIIIil1);},'NQZpK':iII1ll1l(0x24c,'QhFM'),'ipZPh':iII1ll1l(0x255,'k]QK'),'wMHbp':iII1ll1l(0x1e5,'iKcc'),'UOgBA':iII1ll1l(0x256,'k]QK'),'LlWsC':iII1ll1l(0x164,'QhFM'),'gpcWZ':iII1ll1l(0x1b1,'QhFM'),'ZEEhv':iII1ll1l(0x180,'a2KJ')};let iIl1iIII='',lI111ili={};switch(IiIlIi11){case Ilil1ii1[iII1ll1l(0x194,'bYsF')]:case Ilil1ii1[iII1ll1l(0x1c1,'L]Nw')]:iIl1iIII=IiIlIi11,lI111ili={'vendorId':$[iII1ll1l(0x155,'nQ9b')]};break;case Ilil1ii1[iII1ll1l(0x1c5,']$Fw')]:iIl1iIII=IiIlIi11,lI111ili={'vendorId':$[iII1ll1l(0x1f1,'bAIB')],'sourceRpc':Ilil1ii1[iII1ll1l(0x1e2,')f#P')]};break;}return new Promise(async IIiIll1=>{const III1iIIi=iII1ll1l,lIiilIi1=await Ilil1ii1[III1iIIi(0x238,'pdk5')](getSign,iIl1iIII,lI111ili),iIll1lIi={'url':III1iIIi(0x13b,'H%sJ')+IiIlIi11,'headers':{'Host':Ilil1ii1[III1iIIi(0x1d3,'9ShU')],'Content-Type':Ilil1ii1[III1iIIi(0x16d,'BAQ6')],'Accept':Ilil1ii1[III1iIIi(0x217,'umhe')],'Connection':Ilil1ii1[III1iIIi(0x18d,'bAIB')],'Cookie':cookie,'Accept-Language':Ilil1ii1[III1iIIi(0x1ca,'9ShU')],'Accept-Encoding':Ilil1ii1[III1iIIi(0x22d,'qhkn')],'User-Agent':$['UA']},'body':lIiilIi1};$[III1iIIi(0x20f,'r!@Q')](iIll1lIi,(illlIli1,iIIIlliI,i11i1Ill)=>{const l1lIii1i=III1iIIi,lIIliIIl={'FZYCl':function(ili111I1,IlI1liil){const l11l11I=iIl1I11l;return Ilil1ii1[l11l11I(0x1d7,'a2KJ')](ili111I1,IlI1liil);}};try{if(illlIli1)Ilil1ii1[l1lIii1i(0x1e8,'J(QT')](Ilil1ii1[l1lIii1i(0x181,'bAIB')],Ilil1ii1[l1lIii1i(0x1af,'F^)H')])?console[l1lIii1i(0x126,'YS(^')](Ilil1ii1[l1lIii1i(0x25e,'&f)j')](String,illlIli1)):(iilIili1[l1lIii1i(0x1bf,'fatV')](l1lIii1i(0x23f,'14OZ')),Iiil1I1[l1lIii1i(0x1e9,'pdk5')]=!![]);else{i11i1Ill=JSON[l1lIii1i(0x1c3,'0g45')](i11i1Ill);if(Ilil1ii1[l1lIii1i(0x205,'14OZ')](i11i1Ill[l1lIii1i(0x1b7,')f#P')],'0'))switch(IiIlIi11){case Ilil1ii1[l1lIii1i(0x18e,'OaB3')]:$[l1lIii1i(0x117,']$Fw')]=i11i1Ill[l1lIii1i(0x166,')f#P')][l1lIii1i(0x1ea,'BAQ6')][l1lIii1i(0x236,'fatV')];break;case Ilil1ii1[l1lIii1i(0x125,'pdk5')]:for(let iiIii1lI of i11i1Ill[l1lIii1i(0x12d,'pdk5')][l1lIii1i(0x135,'k]QK')]){Ilil1ii1[l1lIii1i(0x1eb,'Z2!O')](Ilil1ii1[l1lIii1i(0x1a4,'PE&K')],Ilil1ii1[l1lIii1i(0x222,'ZcgM')])?console[l1lIii1i(0x151,')f#P')](iiIii1lI):(IiiliiII[l1lIii1i(0x1bf,'fatV')](lIIliIIl[l1lIii1i(0x152,'pdk5')](I1I1iii1,iIl11il1)),llIiIiIi[l1lIii1i(0x151,')f#P')](i1iIi11I[l1lIii1i(0x1a3,'iDlN')]+l1lIii1i(0x198,'umhe')));}console[l1lIii1i(0x1ee,'pdk5')]('');break;case Ilil1ii1[l1lIii1i(0x22e,'qhkn')]:if(i11i1Ill[l1lIii1i(0x165,'TW2(')][l1lIii1i(0x1dd,'$IBB')]){const ll1l1I1I=i11i1Ill[l1lIii1i(0x1be,'J(QT')][l1lIii1i(0x258,'$IBB')][l1lIii1i(0x1a5,'6B*z')]||'';console[l1lIii1i(0x11c,'9ShU')](l1lIii1i(0x184,'BAQ6')+ll1l1I1I[l1lIii1i(0x241,'0g45')]('：')[0x1]),$[l1lIii1i(0x1d2,'s*)p')][l1lIii1i(0x121,'pdk5')](ll1l1I1I);}else console[l1lIii1i(0x239,'Sz2m')](Ilil1ii1[l1lIii1i(0x1bd,'gJdT')]),$[l1lIii1i(0x1d8,'qhkn')][l1lIii1i(0x1bb,'k]QK')]('空气');break;}else console[l1lIii1i(0x138,'bYsF')](i11i1Ill);}}catch(iI11liii){console[l1lIii1i(0x251,'YS(^')](iI11liii,iIIIlliI);}finally{Ilil1ii1[l1lIii1i(0x23a,'J(QT')](Ilil1ii1[l1lIii1i(0x154,'J(QT')],Ilil1ii1[l1lIii1i(0x244,'pdk5')])?Ilil1ii1[l1lIii1i(0x24e,'$IBB')](IIiIll1,i11i1Ill):iIIllii[l1lIii1i(0x1c4,'9ifD')](llIiiII);}});});}function getLoginStatus(){const iIi1l1i1=lillI1II,i11iII1i={'NxzoX':iIi1l1i1(0x1d6,']$Fw'),'BiBrm':iIi1l1i1(0x156,'Sz2m'),'nWwxb':iIi1l1i1(0x14b,'L]Nw'),'iXODG':function(IIiiI11I,IililllI){return IIiiI11I===IililllI;},'kUIOi':function(I1iIiIiI,IilI11i1){return I1iIiIiI(IilI11i1);},'UbVuf':function(I1l1iiii,iIIi1lil){return I1l1iiii!==iIIi1lil;},'TWBSZ':iIi1l1i1(0x189,'bYsF'),'tBJcF':iIi1l1i1(0x123,'0g45'),'zVwxz':function(l111111I,IliIiIl1){return l111111I!==IliIiIl1;},'NMpQd':iIi1l1i1(0x1cf,')f#P'),'FRBqS':iIi1l1i1(0x20d,'s*)p'),'oiuov':iIi1l1i1(0x1f9,'eicZ'),'vyNbR':function(lIilI1l){return lIilI1l();},'hgJAI':function(IIIiIiii,IlIi11li){return IIIiIiii!==IlIi11li;},'qoMAi':iIi1l1i1(0x23d,'bAIB'),'KVnpO':iIi1l1i1(0x211,'r!@Q'),'etpZe':iIi1l1i1(0x19c,'Sz2m'),'tofRy':iIi1l1i1(0x15a,'Z2!O'),'VKXhd':iIi1l1i1(0x148,'I^kH'),'OExny':iIi1l1i1(0x17a,'bAIB'),'qxhCf':iIi1l1i1(0x202,'umhe')};return new Promise(async Il1I1ll1=>{const Il111lI1=iIi1l1i1,l11Iiili={'WVwcQ':i11iII1i[Il111lI1(0x1ad,'r!@Q')],'sBpgF':i11iII1i[Il111lI1(0x149,'9ShU')],'lsyBM':function(lll1iiIi,I1Il1lil){const i1l1ilII=Il111lI1;return i11iII1i[i1l1ilII(0x12c,'r!@Q')](lll1iiIi,I1Il1lil);},'ASwnV':i11iII1i[Il111lI1(0x1b5,'nQ9b')],'pPNix':function(I1ili1Ii,liIlIiil){const l1Ill11i=Il111lI1;return i11iII1i[l1Ill11i(0x1f6,'BAQ6')](I1ili1Ii,liIlIiil);},'xrjKe':function(l1Illi1I,iIi111){const Iiil1ill=Il111lI1;return i11iII1i[Iiil1ill(0x23b,'fatV')](l1Illi1I,iIi111);},'nkskK':i11iII1i[Il111lI1(0x22c,'bAIB')],'VOnGN':i11iII1i[Il111lI1(0x24b,'iT4v')],'TPGNF':function(I11l1il,I1IIl1I1){const IilliiIl=Il111lI1;return i11iII1i[IilliiIl(0x235,'bYsF')](I11l1il,I1IIl1I1);},'yHbwq':function(liiiIlil,liiIIIiI){const Iil1iil=Il111lI1;return i11iII1i[Iil1iil(0x15d,'9ifD')](liiiIlil,liiIIIiI);},'AOZpd':i11iII1i[Il111lI1(0x259,'14OZ')],'jttJZ':i11iII1i[Il111lI1(0x21a,'Ezk&')],'KNmvg':i11iII1i[Il111lI1(0x201,'av8y')],'BrCZX':function(iiIi1lII){const iIIi11l1=Il111lI1;return i11iII1i[iIIi11l1(0x210,'GR6N')](iiIi1lII);}};if(i11iII1i[Il111lI1(0x163,'gJdT')](i11iII1i[Il111lI1(0x145,'Eagh')],i11iII1i[Il111lI1(0x168,'Zum7')])){const i1IIiIil={'url':Il111lI1(0x1b6,'Eagh'),'headers':{'Accept':i11iII1i[Il111lI1(0x22b,'Zum7')],'Accept-Encoding':i11iII1i[Il111lI1(0x223,'866c')],'Accept-Language':i11iII1i[Il111lI1(0x191,'bYsF')],'Connection':i11iII1i[Il111lI1(0x1ce,'TW2(')],'Cookie':cookie,'Host':i11iII1i[Il111lI1(0x1ed,'bYsF')],'User-Agent':$['UA']}};$[Il111lI1(0x245,'9ShU')](i1IIiIil,(iI111I11,iiII1Il,iIi1lII)=>{const lIIii1II=Il111lI1,I1iiIlil={'TaTiu':function(i1i1li1l,iIl1Ili1){const I11ll1l=iIl1I11l;return l11Iiili[I11ll1l(0x147,'L]Nw')](i1i1li1l,iIl1Ili1);},'bOiEl':l11Iiili[lIIii1II(0x124,'(Qk2')],'MDjbF':function(Il1il1I1,il1l11Ii){const li11i11I=lIIii1II;return l11Iiili[li11i11I(0x24f,'av8y')](Il1il1I1,il1l11Ii);}};try{if(l11Iiili[lIIii1II(0x19a,'av8y')](l11Iiili[lIIii1II(0x182,'bYsF')],l11Iiili[lIIii1II(0x199,'a2KJ')]))IIil111=iili11iI[lIIii1II(0x20c,'a2KJ')](l1I1i1II),I1iiIlil[lIIii1II(0x25b,'bYsF')](llli11I[lIIii1II(0x196,'WaCG')],'0')&&(illii111[lIIii1II(0x242,'Eagh')](I1iiIlil[lIIii1II(0x25f,'WaCG')]),llIlIIli[lIIii1II(0x157,'iT4v')][lIIii1II(0x120,'s*)p')](I1iiIlil[lIIii1II(0x1ef,'r!@Q')]),lliilIIi[lIIii1II(0x13e,'iKcc')]=!![]);else{if(iI111I11)console[lIIii1II(0x1ec,'eicZ')](l11Iiili[lIIii1II(0x173,'ZcgM')](String,iI111I11)),console[lIIii1II(0x15c,'Hp[[')]($[lIIii1II(0x158,'a2KJ')]+lIIii1II(0x146,'Ezk&'));else{if(iIi1lII)try{l11Iiili[lIIii1II(0x1b3,'s*)p')](l11Iiili[lIIii1II(0x186,'av8y')],l11Iiili[lIIii1II(0x11e,'bYsF')])?IlIII1[lIIii1II(0x1e4,'s*)p')](I1iiIlil[lIIii1II(0x252,')f#P')](l111l,lI111111)):(iIi1lII=JSON[lIIii1II(0x15e,'&f)j')](iIi1lII),l11Iiili[lIIii1II(0x240,'14OZ')](iIi1lII[lIIii1II(0x12f,'YS(^')],'0')&&(console[lIIii1II(0x136,']$Fw')](l11Iiili[lIIii1II(0x225,']$Fw')]),$[lIIii1II(0x1ae,'iKcc')][lIIii1II(0x20e,'I^kH')](l11Iiili[lIIii1II(0x1c2,'OaB3')]),$[lIIii1II(0x1fb,'YS(^')]=!![]));}catch{if(l11Iiili[lIIii1II(0x11a,'&f)j')](l11Iiili[lIIii1II(0x119,'(Qk2')],l11Iiili[lIIii1II(0x250,'iDlN')])){lIlIll1[lIIii1II(0x140,'Z2!O')](l11Iiili[lIIii1II(0x162,'qhkn')]);return;}else console[lIIii1II(0x11b,'r!@Q')](lIIii1II(0x1dc,'bYsF')),$[lIIii1II(0x159,'(Qk2')]=!![];}else console[lIIii1II(0x1a7,'Ezk&')](lIIii1II(0x1f4,'$IBB')),$[lIIii1II(0x122,'ZcgM')]=!![];}}}catch(I1lIiiI){console[lIIii1II(0x130,'fatV')](I1lIiiI,iiII1Il);}finally{l11Iiili[lIIii1II(0x257,'Eagh')](l11Iiili[lIIii1II(0x1a8,'H%sJ')],l11Iiili[lIIii1II(0x19f,'9ifD')])?l11Iiili[lIIii1II(0x13d,'hQFw')](Il1I1ll1):(l1i1lIi[lIIii1II(0x220,'866c')](l11Iiili[lIIii1II(0x200,'TW2(')]),l1IiiI1l[lIIii1II(0x1f8,'Z2!O')][lIIii1II(0x143,'QhFM')]('空气'));}});}else IIIllii1[Il111lI1(0x14a,'I^kH')](i11iII1i[Il111lI1(0x1e6,'J(QT')]),lIIi1II1[Il111lI1(0x216,'L]Nw')][Il111lI1(0x248,'BAQ6')](i11iII1i[Il111lI1(0x25a,'F^)H')]),il1lIiIl[Il111lI1(0x122,'ZcgM')]=!![];});}var version_ = 'jsjiami.com.v7';

// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
