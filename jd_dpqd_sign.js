/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动
签到后如有奖品则自动到账，只打印签到结果，不打印中奖信息

7 7 7 7 *

*/

const $ = new Env('批量店铺签到')
const jdCookie = require('./jdCookie')
const common = require('./function/jdCommon')
const { H5st } = require('./function/jdCrypto')

var iｉl='jsjiami.com.v7';const l1IIIlI=ili1ll1I;if(function(lIiIli1l,Ill1lii,li1Iil11,llli1IIl,l1lI1i1l,i1lIIl1,l11lllI){return lIiIli1l=lIiIli1l>>0x8,i1lIIl1='hs',l11lllI='hs',function(IlI11ii1,iIilliii,ii1llil1,IllIIiii,i1lIli1l){const i1iI1l1I=ili1ll1I;IllIIiii='tfi',i1lIIl1=IllIIiii+i1lIIl1,i1lIli1l='up',l11lllI+=i1lIli1l,i1lIIl1=ii1llil1(i1lIIl1),l11lllI=ii1llil1(l11lllI),ii1llil1=0x0;const lIli1iil=IlI11ii1();while(!![]&&--llli1IIl+iIilliii){try{IllIIiii=parseInt(i1iI1l1I(0x241,'In2E'))/0x1+parseInt(i1iI1l1I(0x1bd,'0vmH'))/0x2+parseInt(i1iI1l1I(0x210,'wfDS'))/0x3+parseInt(i1iI1l1I(0x208,'TaMX'))/0x4+parseInt(i1iI1l1I(0x195,'BKLY'))/0x5+parseInt(i1iI1l1I(0x262,'BKLY'))/0x6*(-parseInt(i1iI1l1I(0x183,'TaMX'))/0x7)+-parseInt(i1iI1l1I(0x1af,'v#d2'))/0x8;}catch(lI1lIil){IllIIiii=ii1llil1;}finally{i1lIli1l=lIli1iil[i1lIIl1]();if(lIiIli1l<=llli1IIl)ii1llil1?l1lI1i1l?IllIIiii=i1lIli1l:l1lI1i1l=i1lIli1l:ii1llil1=i1lIli1l;else{if(ii1llil1==l1lI1i1l['replace'](/[rtOVMknAqgyGeuExXp=]/g,'')){if(IllIIiii===iIilliii){lIli1iil['un'+i1lIIl1](i1lIli1l);break;}lIli1iil[l11lllI](i1lIli1l);}}}}}(li1Iil11,Ill1lii,function(iiiI11II,llI1lIiI,lI1iiI1,lIIiiil,I11lilll,lIl1,llIiI1ii){return llI1lIiI='\x73\x70\x6c\x69\x74',iiiI11II=arguments[0x0],iiiI11II=iiiI11II[llI1lIiI](''),lI1iiI1=`\x72\x65\x76\x65\x72\x73\x65`,iiiI11II=iiiI11II[lI1iiI1]('\x76'),lIIiiil=`\x6a\x6f\x69\x6e`,(0x15a2c1,iiiI11II[lIIiiil](''));});}(0xc600,0xefa8d,Ii1ililI,0xc8),Ii1ililI){}let tokensList=(process[l1IIIlI(0x20b,'BKLY')][l1IIIlI(0x1c2,'hmdf')]||'')[l1IIIlI(0x1d4,'kNA3')](',')||[],taskThreads=process[l1IIIlI(0x1e8,'TaMX')][l1IIIlI(0x21f,'G&I1')]||'1',accountThreads=process[l1IIIlI(0x1fa,'mBwk')][l1IIIlI(0x245,'BUe0')]||'1';const runInterval=process[l1IIIlI(0x276,'kNA3')][l1IIIlI(0x23f,'J6W7')]||'';function ili1ll1I(_0x1139ba,_0x2e1952){const _0x3e8c92=Ii1ililI();return ili1ll1I=function(_0x37b4df,_0xa07de7){_0x37b4df=_0x37b4df-0x157;let _0x15ff58=_0x3e8c92[_0x37b4df];if(ili1ll1I['VgKuEV']===undefined){var _0x2d9a07=function(_0x3a40db){const _0x54376c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x15cce2='',_0xa6802b='';for(let _0x1dad43=0x0,_0x149abe,_0x20d79a,_0x54bc10=0x0;_0x20d79a=_0x3a40db['charAt'](_0x54bc10++);~_0x20d79a&&(_0x149abe=_0x1dad43%0x4?_0x149abe*0x40+_0x20d79a:_0x20d79a,_0x1dad43++%0x4)?_0x15cce2+=String['fromCharCode'](0xff&_0x149abe>>(-0x2*_0x1dad43&0x6)):0x0){_0x20d79a=_0x54376c['indexOf'](_0x20d79a);}for(let _0x5e4cfd=0x0,_0x2cb192=_0x15cce2['length'];_0x5e4cfd<_0x2cb192;_0x5e4cfd++){_0xa6802b+='%'+('00'+_0x15cce2['charCodeAt'](_0x5e4cfd)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xa6802b);};const _0x4a67df=function(_0x3c842e,_0x3fb020){let _0x341947=[],_0x11b449=0x0,_0x15b5b4,_0x144fe3='';_0x3c842e=_0x2d9a07(_0x3c842e);let _0x1d820e;for(_0x1d820e=0x0;_0x1d820e<0x100;_0x1d820e++){_0x341947[_0x1d820e]=_0x1d820e;}for(_0x1d820e=0x0;_0x1d820e<0x100;_0x1d820e++){_0x11b449=(_0x11b449+_0x341947[_0x1d820e]+_0x3fb020['charCodeAt'](_0x1d820e%_0x3fb020['length']))%0x100,_0x15b5b4=_0x341947[_0x1d820e],_0x341947[_0x1d820e]=_0x341947[_0x11b449],_0x341947[_0x11b449]=_0x15b5b4;}_0x1d820e=0x0,_0x11b449=0x0;for(let _0x166fe8=0x0;_0x166fe8<_0x3c842e['length'];_0x166fe8++){_0x1d820e=(_0x1d820e+0x1)%0x100,_0x11b449=(_0x11b449+_0x341947[_0x1d820e])%0x100,_0x15b5b4=_0x341947[_0x1d820e],_0x341947[_0x1d820e]=_0x341947[_0x11b449],_0x341947[_0x11b449]=_0x15b5b4,_0x144fe3+=String['fromCharCode'](_0x3c842e['charCodeAt'](_0x166fe8)^_0x341947[(_0x341947[_0x1d820e]+_0x341947[_0x11b449])%0x100]);}return _0x144fe3;};ili1ll1I['pzZLNs']=_0x4a67df,_0x1139ba=arguments,ili1ll1I['VgKuEV']=!![];}const _0x3d39fd=_0x3e8c92[0x0],_0x14d7d1=_0x37b4df+_0x3d39fd,_0x545ab6=_0x1139ba[_0x14d7d1];return!_0x545ab6?(ili1ll1I['GKXNpN']===undefined&&(ili1ll1I['GKXNpN']=!![]),_0x15ff58=ili1ll1I['pzZLNs'](_0x15ff58,_0xa07de7),_0x1139ba[_0x14d7d1]=_0x15ff58):_0x15ff58=_0x545ab6,_0x15ff58;},ili1ll1I(_0x1139ba,_0x2e1952);}let TokensMap=null;function Ii1ililI(){const IIIlI11i=(function(){return[...[iｉl,'pjuyskrjqMigEXanemqGixt.VcAuouVmrOV.tuv7==','WO/dOCoBW74w','W6DmW5RdNaW','W6jHW6RdRqmpiq','WPBdSJSsC8k/WP3cT3dcQCkGW64','xMtdGa','rN3cLmoxW68','mhajdSoR','4P2gc+IhMEAEMoI9IEIJTUMbOEwkPEs7OUMxOEIVTCoe','AbpcO8oK','cEkFTtpOR7xMS4VLP57OT7tVVOVML6xLK4FLU53ML5VMJ7tVVjpXHkQN','WRZdULNcU0nCnmkv','WRbPeCorWORcJ8o3W5JcSW','lW81uCkK','WR8zmcH5iSoKW63cGmoCWQlcPSkKWQbhW53dRmkKWP8','W7tdU8kWWPX7','WOPEbvRcLSo4cLddNConW5WQWRddKa','W4DAW7tdRJC','W4eqfSkyBG','W64Bj8kFEa','W7/cIMCJ','WQ/dImokW5m7W4K','WOO4wWnN','WQTIaM3cGq','WOFdImo6y24MWRqLlSoqWP82lHtdRbycW6XaWRddO8oCW44R','bCkiwSozp8orWOVdOXrrW5aBFmoQ','WQb4n8o7WOe','WPNdSSo/rhK','W7OOF8oZia','nvjsvW','W5xdT8oDhCki','ASo8WRdcKmkcW7NcLq','WRVdRKpcPW','lbSRq8kz','44cZ5OYi56sx44gS6k+Z5ysK6iYb5y+xf8otq3Wrza','eCkdW6a','zCo4WQ3cSvW','s8kSwq13vSkzlJZcIqj6vMSMWQfRWQ8JWRu','Fh7cP8odW50','W4yra8kGzq','kmkpySoteq','ESobtKXn','rmoUWQdcG31vF1y','WQC5W7XQhG','77Y78j2OJa','FSkhW4OnCsuei3e','DCkrWQhcQW','BrBcQ8oojG','WRBdTCo2WONcNmoMWPrGrWZdICoKWRffWQxcQ8o8bSojbG','WOFdNmoyWRVcLG','vmo4WOdcUCk9','WPtdSCowtZC','W43dS8kwWQ93','WPSJWRG','WQLthhhcJG','WOVINkJdUEEUSEwiPEAiMowjSG','mwW+jmoc','AmkfWPhcLSoT','dX4Xz8kl','x2ZcJmoqW4K','WP98aHm+WPFdNCkW','W7VcGCkal1m4W4vFW5iTW5C','WQFdKX5KuG','W4vkWOpcGCod','W7e3WRO9yW','4P2jWQNMN67OGkVMRO3NO7BLP7BNKzJdGG','WRK8wCoeFa','qmoCWQdcSZVdG3m2xmkgkg7cGq','oHqDqCkC','iYCxqSkq','W5JcNSoC','i3qVlmoJcCkxWQVcUmoR','W6SBWRaYtW','W7uCkCkeBq','WRpdR8oaWRxcQa','oSoGrdLKt2/dTGb6WQJdMW','WO3dQSo5W4DOeLq','WQpdKbJcGmoX','W6nlWRS','W4JcJIHpuW','ASk3qI5I','W7SCWRC3B2ukuW','pcqPqmkv','W6ZORkVMS5VLK67LURan','W5r2WQRcT8oC','W4b9W4izr8kbjKm','iY/cKfZdIa','smkYghGy','rCkXqXXOamop','W6ldQSoF','wCoRWPBcK1LnDMZcH8osgCkMzCk9WQddRaxcOCkMkW','qeNdNa','WOjobv/cLCo2bG','WQhcR8o+','4PQ/noISMUwfIUI/UEIJOos5TUIhREAEMoInUUwpMUA3OUwjNUs8M+AbQoE8K+wVHEwsHowhRUI8UEIJVoAVRUIfPoACOU++Rq','tCkwWOVcT8oF','c19WDe0','bgm3fmoB','W68lha','a0y5','W7RdPCocgCka'],...(function(){return[...['qmkvW6aWqW','WRVINBKP56Y45yUs5Awq6lAbWR1+ca','rbLkqmoO','WQtcRCoCvNm','WQhdVKhcIf4','WRehzSoLrW','qSkRxHrJaG','WQbaW6PIcJquD8kNW5/dTG0','WPJdQSo8W7O4eLq','xLRdHW3cRmoqW51TWO3dRe3cON8','WRn8eColWOe','WQ0VWP1GW6O','vv3cUvf/','WRRcKSoODea','4PYxe+IePEACNUI/N+IIOUMcJ+wlH+s6I+MuTUISNmoz','WOywW4vSga','nmkIBmoJiW','iHRcGuNdTG','AZa/eKG','gmkcW7e','W6PUW7FdM0noiSoDWPNcVmkcamkhWQDulra','W68zbmktEmkXWR7cKZmGtmkBW4xdPmohthNcTmozBSkBD0xdJa','W70XWOGzuq','WRWIWQ7cMLXyCmoaWRpcUmkGfSke','W4WPWPiHvW','WO3dQSo5','W63dQCkEkSkmW5TS','WQL5pmoCWPtcMCo6W6hcQZ8tW4xcJtWacNxcJ08jgCkFW58','WObJg2JcNW','WR7dLJC','vCotWORcOSkA','WQ3dMCo0W4CuW47dTCkgn8oAb1C','ycfRF8k6tmk0WPlcUCoHW7nF','W7C5WOmvFa','W7KNgSkoAG','WPm+WQK','W4BdV8klWRrA','44ot6lAF5y2p','CSkrWRBcV8ooW5i','D8ktrZ9D','tmkoxsLc','W7nHWPVcK8oV','W6VdPmk7','DSoSWRa','W6VcQSk0W5tdN8kCW4DMzGddRSoSWQG','s3/dG8o1uW','WR3dUCo7W64h','W7yCWQ4','WQ7cN8o2z34','CNxcNq','W6VdRSkYWPj7za','W5JdNCk+WQfwz8kbnSkUWQOps8ocWR3dPa','s0pcLu5I','WR4nr8o+za','W6BdTmobjSkr','aJaMCmkBA8k9','WO7dH8kylZ5DW4lcSqy','WQ7cS8o2t0fmWOG','WOewW4Dymg1F','uIJcVCoVjG','b8kdEmoKgW','W7PXW4OSAq','WOCSWPS','W6bNW7K','WQ3dO8oPW5u+','WP3dQL7cM3W','FhpcPuXe','zmoyWRhcVmkp','x8oGWQ4','W5CQoSkBwa','cqRcH17dSW','EmkBW4i','WOldNCo+','yJCDowhcPG','WQ/dNmowEHq/','CSkBWR8','W6ldPCkQ','WPVdSfFcG1G','EKVdR8keWR4','qfpcICoUW6e','W70QuSowiG','WRldQCocW5CW','vSo3WQdcGW','WPugwCoVFq','dXpcMK7dR8kvWRT5WRBdIG','CSoOWQ3cOSk6W7hcNZS','W77cN8oedr5AW57dHspdTWZdJW','ovfMqN8','WQhdHCofW44s','W5eNWO4rvW','WQxIN6f7566j5yI45AEX6lE/77+e','5lMs5PAw5BsR56YQ','WORdR2FcJKi','xKpdMSknWQ/dVhFdH8kFWPjUW5m','WPvsiCooWPC','W5ZcG8ozebXA','kSoAW6W','W47cHCojgH5hW5K','WOKSWQD7','tvxdImkaWO7dUW','uCoEu2TQzq','WOCEWR5TW7y'],...(function(){return['WOxcKSoUA3y','WOzNn8oaWOi','WPGHWOvAW4W','WQ/dLSoF','WO5xceRcTG','u8k2j0qn','4PMipEIgGEwVVEs4O+I8RUIJVoMuOEMySUAuPUMwQEITGUE+PUMuK+IVQa','W4D2W5ldRs4','aZZcLCknlxFcNSk0CdddTCktW5NcHW','atabBCkm','ar/cL0FdRG','WQ0IDc1v','4PMpWPZORBNLHzVLROFKUzxLVz7OPOVNM4VNJi/LOBxLJ4dPHOZLKltLHiVOVQlOOAdOHPxMNipVV5W','W7hdSCk0WQL9','B8o/WOJcL8k6','WR3dUdzMtq','W7JcRalcMvjCmCkPW4a','WQFdMmomFa','WOfseM/cLa','WRr8cSomWRdcGCoZW5S','vMRdK8oF','sI7cLSoRma','W6G4WPyWEG','mNv4Ah0','5A6Y5lMd6lsU77+55l6w5BEq57I65y2D5yM16l+86kYz5RsZ5yU15zA3772J5y+h55+/552X5yMX55ID5zgU77+b','CdCzohi','nCkzW4hdIL8','WP8sW5LoFgviuLVdGmkC','W6pcUrnTxgdcIW','W6RdQmohlmkrW4H8p3JdGdFcPSoCWRpdNmkByYpdJ2JdMLG2uu3cTSkhW6BcSWPzEmkfnCozW4xcJrtcL3W','fSkivSoHF8ogWO7dRc5l','WRiqDb8','tmovWQ7cUtNcLr0/E8knma','WQKcvqnY','idGsWOBcSW','WRPsb8o0WOC','W5b5W4u4uG','ymkqgeSp','qCkwvZ9i','W4bVWP7cQSot','WQdcTCo6vuK','zJugjexcU8oPhG','uCouwKLSFW','nCk5W6ZdQvm','pZSGWPNcLa','jmkgW7hdH0u','FtSi','i1LNF3K','o3a8kCoRcmkG','WRrlA8ogo8o2W6ZcTb4RBmkwW5y','WONdGCkEsuWcWP/cHsldIXVdJ8oM','W44TsmkgbW','dalcN0NdVSku','qgxcQCoXW4e','r8koWRBcNCoP','WPRdImoOpIu','W7rpWRVcGW','FmoIWOdcU8kM','yrT7w8oy','dWxcPuZdKa','WOCQomk7DSoMWOpcQ8kglWTYWOxdUs9RWRC','WQFdTfC','WQ1FbtaD','WRZdS8obW5i4','W7qCWR4','WR/dL8oPx1i','6lEL5y+Q5PAd5PEWW4tXHzI1','iIm1WP7cKW','EupcQSosW60','W74JhmkNrq','WPP+bCo2WOa','W5ZdLCkWWRTbyCkapW','zmoIWQ7cOCkz','ac8HySkF','vwVdVmkEWQ4','y8oLWQVcUCkC','ignDyYldP8k8t8k1WPKehmk+oa','WRyAWPLeW6K','A0/dL8oACq','q8kQduCX','F8krW4atlhvyEJtdVW','rSk0rrLI','W4aPwSoVnW','W4y1uCobpG','dokEUSkB6kYE5RkR5AAK6ls+776Q','W4ORhSkuqq','qNZcLmo/W78','a004d8oT','qSooWOdcTmkH','W4aHWPeCqW','W7zfk1Kdomo5W53dMmo/WPFcUq','w8kNW4GRyG','W4ikACotfq','W40IimkUDa','WPxdVqVcQ8oB','WRNdMWBcH8ohC8khWPpdQYtcQKddOmk+','tWb/DSoSWP0','WQxdRCoPW4m4','WQNdLCoZWRVcIG'];}())];}())];}());Ii1ililI=function(){return IIIlI11i;};return Ii1ililI();};const CacheFile=__dirname+l1IIIlI(0x19f,'jfux'),cookiesArr=Object[l1IIIlI(0x1f3,'VsDp')](jdCookie)[l1IIIlI(0x25b,']p1G')](iii1iII1=>jdCookie[iii1iII1])[l1IIIlI(0x197,'l!yk')](lI11Ilil=>lI11Ilil);!cookiesArr[0x0]&&($[l1IIIlI(0x24d,'mBwk')]($[l1IIIlI(0x1e2,'0UaW')],l1IIIlI(0x1e7,'4hFR')),process[l1IIIlI(0x27c,'G&I1')](0x1));!(async()=>{const iIIl11I1=l1IIIlI,il1iIl1l={'licvm':function(l1li1I11,lI1ill1I){return l1li1I11(lI1ill1I);},'PkgLO':function(iIiIillI,l11111ll){return iIiIillI>l11111ll;},'enVqK':function(Illl11I1,l11lll1I){return Illl11I1!==l11lll1I;},'tuylb':iIIl11I1(0x280,'BKLY'),'ceTCe':iIIl11I1(0x19a,'EeM9'),'ktdzu':function(iIIIII1l,i1liIIiI,IIlIl1II,IiliIIii,ill1i1iI,il1IiiI){return iIIIII1l(i1liIIiI,IIlIl1II,IiliIIii,ill1i1iI,il1IiiI);},'ATzbY':function(IiliiII,Iil1i1li){return IiliiII!==Iil1i1li;},'kvKsE':iIIl11I1(0x240,'nb&Q'),'yMGwG':iIIl11I1(0x1fb,')C5p'),'RWalP':function(l1IIilI,II111l){return l1IIilI>II111l;},'ltBYF':function(IliI11il,ilIIii1i){return IliI11il<=ilIIii1i;},'elhdf':function(i111lii1,iIlIII1){return i111lii1===iIlIII1;},'JxJZx':iIIl11I1(0x215,'4hFR'),'TZKul':iIIl11I1(0x16f,'EeM9'),'vNqWd':function(I1IIi1iI,i1IIlil1){return I1IIi1iI(i1IIlil1);},'ytdKM':iIIl11I1(0x26a,'gNl('),'DmMof':iIIl11I1(0x1e9,'G&I1'),'DXeUY':iIIl11I1(0x223,']p1G'),'UdLcF':function(illIiIil,lIiii11i){return illIiIil===lIiii11i;},'vqINW':iIIl11I1(0x20a,'qX4l'),'OIFhP':iIIl11I1(0x26d,'Dg8x'),'oTiUE':function(ilIilII1,II1IIi1I){return ilIilII1!==II1IIi1I;},'PtRPr':iIIl11I1(0x167,')C5p'),'acvhc':iIIl11I1(0x258,'gNl('),'AyzHd':iIIl11I1(0x169,'1Zq^'),'bbYpp':function(iiIili1i,lI1liIi){return iiIili1i!==lI1liIi;},'PAQHV':iIIl11I1(0x168,'wfDS'),'ySpby':iIIl11I1(0x1eb,'Z*is'),'ITWEl':function(liill1iI,Ii1iI1iI){return liill1iI!==Ii1iI1iI;},'OSmHc':iIIl11I1(0x248,'Dg8x'),'EBnWw':iIIl11I1(0x1cb,'Z*is'),'hVDpG':function(IIiI11iI,II1ii1){return IIiI11iI(II1ii1);},'eKvsu':function(I11IIIli,liliII1l){return I11IIIli>liliII1l;},'KNOPs':function(IIliI11I,iIii1i1){return IIliI11I!==iIii1i1;},'HrhYQ':function(i111l1li,l1iII111){return i111l1li===l1iII111;},'IDcaS':iIIl11I1(0x163,'H#Cp'),'zdPBY':iIIl11I1(0x225,'0UaW'),'FNlWg':function(iillilii,lIll1l1){return iillilii!==lIll1l1;},'GGDbO':iIIl11I1(0x184,'0vmH'),'YTznw':iIIl11I1(0x1c4,'gNl(')};try{if(il1iIl1l[iIIl11I1(0x18e,'TaMX')](il1iIl1l[iIIl11I1(0x185,'$@9)')],il1iIl1l[iIIl11I1(0x1ad,'3X9N')])){if(il1iIl1l[iIIl11I1(0x26f,'J6W7')](tokensList[iIIl11I1(0x274,'L@lu')],0x0))tokensList=[...new Set(tokensList[iIIl11I1(0x1c3,'jTwe')](IIliiili=>IIliiili!==''))];if(il1iIl1l[iIIl11I1(0x20f,'hw0Q')](tokensList[iIIl11I1(0x18d,'nx0!')],0x0)){if(il1iIl1l[iIIl11I1(0x1b4,'4hFR')](il1iIl1l[iIIl11I1(0x279,'Z*is')],il1iIl1l[iIIl11I1(0x1f9,'kNA3')])){console[iIIl11I1(0x166,'L@lu')](il1iIl1l[iIIl11I1(0x242,'nb&Q')]);return;}else ll11iIll=0x1;}const III1iIii=il1iIl1l[iIIl11I1(0x237,'H#Cp')](require,'fs');if(III1iIii[iIIl11I1(0x27e,'l!yk')](CacheFile)){const liliIiiI=III1iIii[iIIl11I1(0x249,'UoFr')](CacheFile,il1iIl1l[iIIl11I1(0x1df,'BUe0')]),ll1iiiii=JSON[iIIl11I1(0x20e,'J6W7')](liliIiiI);TokensMap=new Map();for(const l1Iiiii1 in ll1iiiii){TokensMap[iIIl11I1(0x255,'Dg8x')](l1Iiiii1,ll1iiiii[l1Iiiii1]);}}else{if(il1iIl1l[iIIl11I1(0x1c0,'jfux')](il1iIl1l[iIIl11I1(0x257,'qxb3')],il1iIl1l[iIIl11I1(0x1d7,'J6W7')])){const IlIiIi1=il1iIl1l[iIIl11I1(0x175,')C5p')](i1iI1lII,iilliil1);il1iIl1l[iIIl11I1(0x1a4,'EeM9')](IlIiIi1,0x0)&&il1iIl1l[iIIl11I1(0x266,'CxSY')](IlIiIi1,0x1)&&(li11ilI1=IlIiIi1);}else{console[iIIl11I1(0x220,'3X9N')](il1iIl1l[iIIl11I1(0x219,'#5Ar')]);return;}}$[iIIl11I1(0x18c,'v#d2')]=null;if(runInterval)try{if(il1iIl1l[iIIl11I1(0x204,'#5Ar')](il1iIl1l[iIIl11I1(0x1fe,'VsDp')],il1iIl1l[iIIl11I1(0x1db,'0vmH')]))iiiiilil[iIIl11I1(0x166,'L@lu')](iIi1I11l),Illliiii&&(l1i1i[iIIl11I1(0x1c8,'In2E')]=!![]);else{const I1IilI1=il1iIl1l[iIIl11I1(0x1c5,'hw0Q')](parseInt,runInterval);il1iIl1l[iIIl11I1(0x190,'TaMX')](I1IilI1,0x0)&&(il1iIl1l[iIIl11I1(0x27a,'gRRV')](il1iIl1l[iIIl11I1(0x1bf,'gRRV')],il1iIl1l[iIIl11I1(0x17c,'v#d2')])?$[iIIl11I1(0x1aa,'05zC')]=I1IilI1:(delete lI11l1li[iIIl11I1(0x177,'qxb3')],delete II1iiii[iIIl11I1(0x193,'wevP')][il1iIl1l[iIIl11I1(0x18f,'$@9)')]]));}}catch{console[iIIl11I1(0x26e,'G&I1')](il1iIl1l[iIIl11I1(0x1b2,'wfDS')]);}try{if(il1iIl1l[iIIl11I1(0x281,'0UaW')](il1iIl1l[iIIl11I1(0x18a,'#5Ar')],il1iIl1l[iIIl11I1(0x162,'mBwk')])){const i11i11iI=il1iIl1l[iIIl11I1(0x1e0,'EeM9')](parseInt,taskThreads);il1iIl1l[iIIl11I1(0x1b5,'gRRV')](i11i11iI,0x0)&&il1iIl1l[iIIl11I1(0x283,'nb&Q')](i11i11iI,0x1)&&(taskThreads=i11i11iI);}else{const IIiliIIi=il1I1lI[iIIl11I1(0x15a,'3X9N')](i1l1Ili,il1iIl1l[iIIl11I1(0x1cc,'wevP')]),lIiIiIl1=II111I1l[iIIl11I1(0x234,'BUe0')](IIiliIIi);iiII1IIi=new iiII1il1();for(const I1l11I in lIiIiIl1){IIllill[iIIl11I1(0x255,'Dg8x')](I1l11I,lIiIiIl1[I1l11I]);}}}catch{if(il1iIl1l[iIIl11I1(0x19e,'l!yk')](il1iIl1l[iIIl11I1(0x1be,'sEEh')],il1iIl1l[iIIl11I1(0x1a1,'1Zq^')]))taskThreads=0x1;else{const iI11l1II=il1iIl1l[iIIl11I1(0x18b,'H#Cp')](i1II1ill,II1IIli1);il1iIl1l[iIIl11I1(0x277,'9T8g')](iI11l1II,0x0)&&il1iIl1l[iIIl11I1(0x1c6,'gNl(')](iI11l1II,0x1)&&(lllI1I1I=iI11l1II);}}try{const iI1l1lI1=il1iIl1l[iIIl11I1(0x1e1,'gRRV')](parseInt,accountThreads);il1iIl1l[iIIl11I1(0x1ff,'qX4l')](iI1l1lI1,0x0)&&il1iIl1l[iIIl11I1(0x22f,'1F@[')](iI1l1lI1,0x1)&&(il1iIl1l[iIIl11I1(0x19d,'jTwe')](il1iIl1l[iIIl11I1(0x21b,'l!yk')],il1iIl1l[iIIl11I1(0x23c,'v#d2')])?iii1il[iIIl11I1(0x27f,'Dg8x')]=iIllilil:accountThreads=iI1l1lI1);}catch{accountThreads=0x1;}await common[iIIl11I1(0x216,'nb&Q')](accountThreads,cookiesArr,async(iilIli1l,Illilili)=>{const ll1IiiI=iIIl11I1;await il1iIl1l[ll1IiiI(0x16d,'l!yk')](concMain,taskThreads,tokensList,iilIli1l,Illilili,Main);if($[ll1IiiI(0x1ef,'G&I1')])$[ll1IiiI(0x182,'0vmH')]($[ll1IiiI(0x201,'1Zq^')]);});}else I1lI11iI[iIIl11I1(0x213,'#5Ar')](i1iiII11,llilI11l[ill111l]);}catch(lIIIliIl){il1iIl1l[iIIl11I1(0x1e6,'qX4l')](il1iIl1l[iIIl11I1(0x1bb,'Dg8x')],il1iIl1l[iIIl11I1(0x265,'(j[!')])?console[iIIl11I1(0x271,'sEEh')](iIIl11I1(0x1cd,'Z*is')+lIIIliIl):Illiiil1[iIIl11I1(0x1e4,'Dg8x')]=!![];}})()[l1IIIlI(0x270,'l!yk')](I1lili11=>$[l1IIIlI(0x161,'nx0!')](I1lili11))[l1IIIlI(0x21d,'4hFR')](()=>$[l1IIIlI(0x1d9,'z!jP')]());async function Main(IiiiI1lI,I1I1iii){const illlllIl=l1IIIlI,l1ili1ii={'VOBvs':function(ll1Ii1Ii,Ili1lIil){return ll1Ii1Ii(Ili1lIil);},'QqDoS':function(IIi1ili,IlIIl111){return IIi1ili>IlIIl111;},'VqnTk':illlllIl(0x25d,'05zC'),'WvjYU':function(Ili1II1I,Ii1i111i){return Ili1II1I===Ii1i111i;},'HWWKf':function(iliiIIlI,iIli1lIi){return iliiIIlI===iIli1lIi;},'TKjBY':function(l11iiIl1,iI1liIi1){return l11iiIl1!==iI1liIi1;},'byciL':illlllIl(0x1dc,')C5p'),'QiRDx':illlllIl(0x22d,'H#Cp'),'mpYBa':illlllIl(0x17b,'$@9)'),'jXDwc':illlllIl(0x158,'nb&Q'),'iFGZr':function(iliIiill,li1iiII){return iliIiill===li1iiII;},'bCoDZ':illlllIl(0x172,'H27k'),'JbLFA':function(Iilii1ll,i1llii){return Iilii1ll(i1llii);},'EZrEZ':function(Ii1i1i){return Ii1i1i();},'jeqGI':illlllIl(0x227,'jfux'),'DDnKP':illlllIl(0x196,'1F@['),'PAZUb':illlllIl(0x180,'ti#]'),'flKUC':illlllIl(0x1f5,'hw0Q'),'YDpdo':function(IiIiiiil,iI1illll){return IiIiiiil(iI1illll);},'oJZAG':illlllIl(0x15d,'VsDp'),'poAcF':illlllIl(0x1dd,'EeM9'),'oVpTF':illlllIl(0x1f2,'sEEh'),'MmaAz':illlllIl(0x171,'Dg8x'),'fjlOw':illlllIl(0x1ac,'qX4l'),'UGOdP':illlllIl(0x228,'jTwe'),'keFyr':illlllIl(0x23e,'In2E'),'JITSV':illlllIl(0x1d3,'0vmH'),'mXjqf':illlllIl(0x1b3,'sEEh'),'ZEmfh':illlllIl(0x181,'CxSY'),'hSiFb':illlllIl(0x1c9,'H27k'),'XRHHx':illlllIl(0x1ea,'4hFR'),'Hqrtm':illlllIl(0x273,'v#d2'),'OVEcI':illlllIl(0x244,'ti#]'),'cgHNm':illlllIl(0x17e,'L4pr'),'mUWtb':function(i11IIi1l,lillii1I){return i11IIi1l===lillii1I;},'cOTqj':illlllIl(0x1ec,'J6W7'),'ykDmH':illlllIl(0x280,'BKLY'),'CupqH':function(il1i11l,iI1lilli){return il1i11l<iI1lilli;},'iDciX':function(i1i1I1I,ili1ilil,IIlII1iI){return i1i1I1I(ili1ilil,IIlII1iI);},'TWxLK':function(liIii1Il,lIIiI11i){return liIii1Il>=lIIiI11i;},'PXeBc':function(I1lIl11i,iiiIl1l1){return I1lIl11i/ iiiIl1l1;},'yOdLc':function(iilIiil1,iIli1I1l){return iilIiil1||iIli1I1l;}},{title:l1l1111i,UA:II1Illl1,cookie:i11iIiII}=I1I1iii,Ilil11I=TokensMap[illlllIl(0x243,'gNl(')](IiiiI1lI);if(!Ilil11I)return;const I1Iii1I1=Math[illlllIl(0x1ae,'Dg8x')](l1ili1ii[illlllIl(0x1ba,'wevP')](Date[illlllIl(0x259,'nb&Q')](),0x3e8))+illlllIl(0x268,'&)]I'),{venderId:liiIII1i,activityId:i1II}=Ilil11I;if(l1ili1ii[illlllIl(0x186,'BUe0')](!liiIII1i,!i1II))return;await l1ili1ii[illlllIl(0x15b,'BUe0')](ilIiiII,l1ili1ii[illlllIl(0x217,'qX4l')]);if($[illlllIl(0x21a,'&)]I')])$[illlllIl(0x15f,'mBwk')]($[illlllIl(0x1d0,'9T8g')]);async function IiIii11l(IiIl1lli,i1IlI111){const Il1iI1i1=illlllIl,II111il1={'FUoUj':function(illIliI1,iIiii1i1){const lI11Il=ili1ll1I;return l1ili1ii[lI11Il(0x23a,'CxSY')](illIliI1,iIiii1i1);},'WHnRW':function(lIIil1l,l1lIlIIl){const IllIl=ili1ll1I;return l1ili1ii[IllIl(0x1f7,'Dg8x')](lIIil1l,l1lIlIIl);}};try{switch(IiIl1lli){case l1ili1ii[Il1iI1i1(0x26b,'9T8g')]:if(l1ili1ii[Il1iI1i1(0x226,'wevP')](i1IlI111[Il1iI1i1(0x1ce,'(j[!')],0xc8)&&l1ili1ii[Il1iI1i1(0x1b9,'Z*is')](i1IlI111[Il1iI1i1(0x17f,'XCiE')],!![]))console[Il1iI1i1(0x23d,'TaMX')](''+l1l1111i+IiiiI1lI+Il1iI1i1(0x1fc,'05zC'));else{if(i1IlI111[Il1iI1i1(0x222,'H#Cp')]){if(l1ili1ii[Il1iI1i1(0x251,'4hFR')](l1ili1ii[Il1iI1i1(0x1fd,'wevP')],l1ili1ii[Il1iI1i1(0x24c,'jfux')])){const ll1iIiI1=i1IlI111[Il1iI1i1(0x269,'In2E')];let i1l1liil=ll1iIiI1;switch(ll1iIiI1){case l1ili1ii[Il1iI1i1(0x22c,'jTwe')]:i1l1liil=l1ili1ii[Il1iI1i1(0x1c7,'In2E')];break;}console[Il1iI1i1(0x1a3,'nb&Q')](''+l1l1111i+IiiiI1lI+Il1iI1i1(0x157,'J6W7')+i1l1liil+'）');}else{const Il11Il1I=II111il1[Il1iI1i1(0x1d8,'jfux')](il1i11Ii,IIi1l1ll);II111il1[Il1iI1i1(0x1f8,'L@lu')](Il11Il1I,0x0)&&(I1iIilI1[Il1iI1i1(0x176,'BUe0')]=Il11Il1I);}}else l1ili1ii[Il1iI1i1(0x17a,'0UaW')](l1ili1ii[Il1iI1i1(0x25a,'H#Cp')],l1ili1ii[Il1iI1i1(0x188,'wfDS')])?console[Il1iI1i1(0x254,'kNA3')](''+l1l1111i+IiiiI1lI+Il1iI1i1(0x22b,'z!jP')+JSON[Il1iI1i1(0x1d1,'BUe0')](i1IlI111)):Ilil1111[Il1iI1i1(0x191,'v#d2')](Il1iI1i1(0x238,'0UaW')+lllllII1);}break;}}catch(l1lIli1){console[Il1iI1i1(0x275,'VsDp')](Il1iI1i1(0x206,'Dg8x')+IiIl1lli+Il1iI1i1(0x218,'H#Cp')+(l1lIli1[Il1iI1i1(0x264,'L4pr')]||l1lIli1));}}async function ilIiiII(i11IiIll){const IiliIlil=illlllIl,IIlii111={'xjXMv':function(I1ii11il,II1I1lI){const i1iIlli1=ili1ll1I;return l1ili1ii[i1iIlli1(0x1ed,'CxSY')](I1ii11il,II1I1lI);},'ycqPc':function(I1li1ii1){const lIiI11li=ili1ll1I;return l1ili1ii[lIiI11li(0x1d2,'qX4l')](I1li1ii1);}};let l1lII1I1='',IllI11i1=null,l1I1ilil=null,Il1IIi1=l1ili1ii[IiliIlil(0x239,'L4pr')],li1I1i={},l111I1II={};switch(i11IiIll){case l1ili1ii[IiliIlil(0x1e3,'ti#]')]:l111I1II={'appId':l1ili1ii[IiliIlil(0x25f,'1F@[')],'functionId':l1ili1ii[IiliIlil(0x209,'qX4l')],'appid':l1ili1ii[IiliIlil(0x165,'mBwk')],'body':{'token':IiiiI1lI,'venderId':l1ili1ii[IiliIlil(0x16a,'In2E')](parseInt,liiIII1i)||'','activityId':l1ili1ii[IiliIlil(0x1b1,'qxb3')](parseInt,i1II)||'','type':0x38,'actionType':0x7},'version':l1ili1ii[IiliIlil(0x24b,'nb&Q')],'ua':II1Illl1},li1I1i=await H5st[IiliIlil(0x211,'gNl(')](l111I1II),l1lII1I1=l1ili1ii[IiliIlil(0x212,'hmdf')],l1I1ilil=Object[IiliIlil(0x15c,'BKLY')]({},li1I1i[IiliIlil(0x20c,'wevP')],{'jsonp':l1ili1ii[IiliIlil(0x252,'4hFR')]});break;}const lIIIIi1={'t':I1Iii1I1,'loginType':'2'};IllI11i1&&Object[IiliIlil(0x160,'3X9N')](IllI11i1,lIIIIi1);l1I1ilil&&(l1ili1ii[IiliIlil(0x1b0,'mBwk')](l1ili1ii[IiliIlil(0x267,'&)]I')],l1ili1ii[IiliIlil(0x1f4,'(j[!')])?l1llIlI1=liI11iIi:Object[IiliIlil(0x230,'4hFR')](l1I1ilil,lIIIIi1));const II1Il1I={'url':l1lII1I1,'method':Il1IIi1,'headers':{'Accept':l1ili1ii[IiliIlil(0x200,'Z*is')],'Accept-Encoding':l1ili1ii[IiliIlil(0x16c,'qX4l')],'Accept-Language':l1ili1ii[IiliIlil(0x236,']p1G')],'Connection':l1ili1ii[IiliIlil(0x246,')C5p')],'Content-Type':l1ili1ii[IiliIlil(0x170,'05zC')],'Host':l1ili1ii[IiliIlil(0x16e,'0vmH')],'Referer':l1ili1ii[IiliIlil(0x1bc,'nb&Q')],'Sec-Fetch-Dest':l1ili1ii[IiliIlil(0x23b,'l!yk')],'Sec-Fetch-Mode':l1ili1ii[IiliIlil(0x1b8,'J6W7')],'Sec-Fetch-Site':l1ili1ii[IiliIlil(0x26c,']p1G')],'User-Agent':II1Illl1,'Cookie':i11iIiII},'params':l1I1ilil,'data':IllI11i1,'timeout':0x7530};l1ili1ii[IiliIlil(0x27b,'UoFr')](Il1IIi1,l1ili1ii[IiliIlil(0x22e,'9T8g')])&&(l1ili1ii[IiliIlil(0x1b6,'gRRV')](l1ili1ii[IiliIlil(0x253,'#5Ar')],l1ili1ii[IiliIlil(0x1a2,'UoFr')])?(IIlii111[IiliIlil(0x192,'0UaW')](iiIII1Ii,lilil1l1),IIlii111[IiliIlil(0x229,'ti#]')](iI11lIII)):(delete II1Il1I[IiliIlil(0x174,'L@lu')],delete II1Il1I[IiliIlil(0x261,'qX4l')][l1ili1ii[IiliIlil(0x19c,'Dg8x')]]));const IllIliI=0x3;let lIii1l1=0x0,lliliI1l=null,l11II1iI=![];while(l1ili1ii[IiliIlil(0x207,'1F@[')](lIii1l1,IllIliI)){const lI1llili=await common[IiliIlil(0x232,'gNl(')](II1Il1I);if(!lI1llili[IiliIlil(0x15e,'BKLY')]){lliliI1l=''+l1l1111i+IiiiI1lI+IiliIlil(0x1b7,'3X9N')+lI1llili[IiliIlil(0x260,'ti#]')]+IiliIlil(0x1f1,'qxb3'),lIii1l1++;continue;}if(!lI1llili[IiliIlil(0x19b,'#5Ar')]){lliliI1l=''+l1l1111i+IiiiI1lI+IiliIlil(0x1cf,'jTwe'),lIii1l1++;continue;}l1ili1ii[IiliIlil(0x205,'nb&Q')](IiIii11l,i11IiIll,lI1llili[IiliIlil(0x177,'qxb3')]),l11II1iI=![];break;}l1ili1ii[IiliIlil(0x25e,']p1G')](lIii1l1,IllIliI)&&(console[IiliIlil(0x1a0,'9T8g')](lliliI1l),l11II1iI&&($[IiliIlil(0x221,')C5p')]=!![]));}}async function concMain(l1IiiIIi=0x1,I1III1ll,Il1l1IIi,IIlIiI1l,iII1IIII){const IlllilI1=l1IIIlI,i1iiiiIi={'JNjEX':function(Ill1lIlI,i1IIlili,iiiI1II){return Ill1lIlI(i1IIlili,iiiI1II);},'KJHAO':function(liill11){return liill11();},'akjww':function(IlIIi1II,I111I11I){return IlIIi1II<I111I11I;},'imlke':function(iillI1Ii,I1II1lI1){return iillI1Ii>I1II1lI1;},'VmTmW':function(lI1iI1ii,l11lIIII){return lI1iI1ii(l11lIIII);},'AtWAU':function(iliI1ilI,liiI1I1I){return iliI1ilI===liiI1I1I;},'GpzbU':function(Ii1I1iIi){return Ii1I1iIi();},'SbSoe':function(IlI11l1i,Iil1IiI){return IlI11l1i(Iil1IiI);},'pKOdA':function(IIiilII1){return IIiilII1();},'YcfNd':IlllilI1(0x1da,'UoFr'),'oOpZI':IlllilI1(0x263,'H#Cp'),'FBRHl':function(liIIiIl,IiIi1l){return liIIiIl<IiIi1l;},'bNzBL':function(iii1lIi,IlI1I11l){return iii1lIi===IlI1I11l;},'YznES':IlllilI1(0x164,'BUe0'),'PQLXL':IlllilI1(0x178,'(j[!'),'XGZWx':function(Iiiiil1l,Iili1lIi){return Iiiiil1l(Iili1lIi);}},I1i11lIi=I1III1ll[IlllilI1(0x272,'EeM9')](IiiIiii1=>IiiIiii1),lIi1Il1=i1iiiiIi[IlllilI1(0x224,'VsDp')](decodeURIComponent,common[IlllilI1(0x1d5,')C5p')](Il1l1IIi,i1iiiiIi[IlllilI1(0x1a9,'BUe0')])),lIil1lli=IlllilI1(0x24f,'L@lu')+IIlIiI1l+'】'+lIi1Il1+'：',lil1I11={'title':lIil1lli,'UA':common[IlllilI1(0x187,'&)]I')](lIi1Il1),'cookie':Il1l1IIi,'index':IIlIiI1l},lIl1I1i=await common[IlllilI1(0x1de,'CxSY')](Il1l1IIi);if(!lIl1I1i&&i1iiiiIi[IlllilI1(0x24e,'kNA3')](typeof lIl1I1i,i1iiiiIi[IlllilI1(0x27d,'1F@[')])){console[IlllilI1(0x1ca,'qxb3')](lIil1lli+IlllilI1(0x1a5,'BUe0'));return;}let I1IiI1i=0x0;async function II1ilIl1(lil111Ii){const IilIlIlI=IlllilI1;await i1iiiiIi[IilIlIlI(0x198,'Z*is')](iII1IIII,lil111Ii,lil1I11),I1IiI1i--,i1iiiiIi[IilIlIlI(0x282,'gNl(')](IiilIII1);}async function IiilIII1(){const lIilil1=IlllilI1;while(i1iiiiIi[lIilil1(0x1ab,'Dg8x')](I1IiI1i,l1IiiIIi)&&i1iiiiIi[lIilil1(0x1a6,'$@9)')](I1i11lIi[lIilil1(0x250,'VsDp')],0x0)){const lillllli=I1i11lIi[lIilil1(0x1a7,'Z*is')]();I1IiI1i++,await i1iiiiIi[lIilil1(0x1a8,'jfux')](II1ilIl1,lillllli);}}const ilIl1i1I=Math[IlllilI1(0x247,'hmdf')](I1i11lIi[IlllilI1(0x25c,'kNA3')],l1IiiIIi),Il111l1=[];for(let IiI1lI1i=0x0;i1iiiiIi[IlllilI1(0x1c1,'hmdf')](IiI1lI1i,ilIl1i1I);IiI1lI1i++){if(i1iiiiIi[IlllilI1(0x189,'4hFR')](i1iiiiIi[IlllilI1(0x199,'VsDp')],i1iiiiIi[IlllilI1(0x203,'H27k')]))i1iiiiIi[IlllilI1(0x17d,'TaMX')](lliiIlil,0x0)&&(i1iiiiIi[IlllilI1(0x278,'3X9N')](iIIillII,i1lii1ll),i1iiiiIi[IlllilI1(0x1ee,'nx0!')](iillIIil));else{const liIii1Ii=I1i11lIi[IlllilI1(0x20d,'nb&Q')]();I1IiI1i++,Il111l1[IlllilI1(0x1e5,'9T8g')](i1iiiiIi[IlllilI1(0x1f6,'hw0Q')](II1ilIl1,liIii1Ii));}}await Promise[IlllilI1(0x21e,'ti#]')](Il111l1),i1iiiiIi[IlllilI1(0x1f0,'L4pr')](IiilIII1),await new Promise(i11lI1il=>{const i11llIll=IlllilI1,illI1I1l={'TaESB':function(il1l1i1l,l1lil1I1){const l11ll=ili1ll1I;return i1iiiiIi[l11ll(0x159,'9T8g')](il1l1i1l,l1lil1I1);},'XBXAj':function(Il11l1il,l1Iliili){const li1lIilI=ili1ll1I;return i1iiiiIi[li1lIilI(0x235,'mBwk')](Il11l1il,l1Iliili);},'JaowM':function(llI11l1l){const i1I1lilI=ili1ll1I;return i1iiiiIi[i1I1lilI(0x179,'nb&Q')](llI11l1l);}},ii11I1li=i1iiiiIi[i11llIll(0x1d6,'In2E')](setInterval,()=>{const iI1II=i11llIll;illI1I1l[iI1II(0x22a,'sEEh')](I1IiI1i,0x0)&&(illI1I1l[iI1II(0x214,'XCiE')](clearInterval,ii11I1li),illI1I1l[iI1II(0x21c,'wfDS')](i11lI1il));},0x64);});}var version_ = 'jsjiami.com.v7';

// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
