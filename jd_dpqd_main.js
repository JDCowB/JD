/*
活动名称：批量店铺签到（活动查询）
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号分割

查询活动信息主脚本，IP限制严重建议使用代理，请勿频繁运行
自动去重并过滤无效活动，默认过滤垃圾奖品活动
运行后会在本地目录生成缓存文件以用于签到脚本使用

7 7 7 7 *

*/

const $ = new Env('批量店铺签到（活动查询）')
const common = require('./function/jdCommon')
const { H5st, jsTk } = require('./function/jdCrypto')

var iｉl='jsjiami.com.v7';function I11IliI1(_0x568b19,_0x2ff23e){const _0x340602=IIiiI11();return I11IliI1=function(_0x5308c2,_0x5dd692){_0x5308c2=_0x5308c2-0x1af;let _0x3cb005=_0x340602[_0x5308c2];if(I11IliI1['JDtLcm']===undefined){var _0x374307=function(_0x2352db){const _0x1da0f9='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1c0027='',_0x2527b5='';for(let _0x3ba76a=0x0,_0x103866,_0x55d241,_0x10637c=0x0;_0x55d241=_0x2352db['charAt'](_0x10637c++);~_0x55d241&&(_0x103866=_0x3ba76a%0x4?_0x103866*0x40+_0x55d241:_0x55d241,_0x3ba76a++%0x4)?_0x1c0027+=String['fromCharCode'](0xff&_0x103866>>(-0x2*_0x3ba76a&0x6)):0x0){_0x55d241=_0x1da0f9['indexOf'](_0x55d241);}for(let _0x45b72b=0x0,_0x18033f=_0x1c0027['length'];_0x45b72b<_0x18033f;_0x45b72b++){_0x2527b5+='%'+('00'+_0x1c0027['charCodeAt'](_0x45b72b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2527b5);};const _0xe9bc62=function(_0x8bbfde,_0x53b3f2){let _0x265820=[],_0x5ca2c1=0x0,_0x63c048,_0x2794e9='';_0x8bbfde=_0x374307(_0x8bbfde);let _0x37822f;for(_0x37822f=0x0;_0x37822f<0x100;_0x37822f++){_0x265820[_0x37822f]=_0x37822f;}for(_0x37822f=0x0;_0x37822f<0x100;_0x37822f++){_0x5ca2c1=(_0x5ca2c1+_0x265820[_0x37822f]+_0x53b3f2['charCodeAt'](_0x37822f%_0x53b3f2['length']))%0x100,_0x63c048=_0x265820[_0x37822f],_0x265820[_0x37822f]=_0x265820[_0x5ca2c1],_0x265820[_0x5ca2c1]=_0x63c048;}_0x37822f=0x0,_0x5ca2c1=0x0;for(let _0x1416b9=0x0;_0x1416b9<_0x8bbfde['length'];_0x1416b9++){_0x37822f=(_0x37822f+0x1)%0x100,_0x5ca2c1=(_0x5ca2c1+_0x265820[_0x37822f])%0x100,_0x63c048=_0x265820[_0x37822f],_0x265820[_0x37822f]=_0x265820[_0x5ca2c1],_0x265820[_0x5ca2c1]=_0x63c048,_0x2794e9+=String['fromCharCode'](_0x8bbfde['charCodeAt'](_0x1416b9)^_0x265820[(_0x265820[_0x37822f]+_0x265820[_0x5ca2c1])%0x100]);}return _0x2794e9;};I11IliI1['uURwnK']=_0xe9bc62,_0x568b19=arguments,I11IliI1['JDtLcm']=!![];}const _0x5ccb89=_0x340602[0x0],_0x2ac05b=_0x5308c2+_0x5ccb89,_0x554b68=_0x568b19[_0x2ac05b];return!_0x554b68?(I11IliI1['zDkZvX']===undefined&&(I11IliI1['zDkZvX']=!![]),_0x3cb005=I11IliI1['uURwnK'](_0x3cb005,_0x5dd692),_0x568b19[_0x2ac05b]=_0x3cb005):_0x3cb005=_0x554b68,_0x3cb005;},I11IliI1(_0x568b19,_0x2ff23e);}const iIiii=I11IliI1;function IIiiI11(){const l1i1IiiI=(function(){return[...[iｉl,'kVpjwRsDjeMiQSaWmiK.QcwPdom.PCvp7QkJxQYw==','lCo9W5ldJ04','W4jpW47cL2NdISoj','eSkUW4GNoa','W4fQANddHgfzWRXTC8kV','cfBdTgJdMsG','W4uNW7iKWP1t','WPOWomoRdCkqu8o9W6KnW6nszq','EgDRWPnvW5ldItNcSSk/uG','44cqzow6REMrQ+wtHUELIo+8GrO','oUw/L+wNN++8IUAyJoEdSUwfH+ACVowsVa8','iSknWQK','cSkAW642fK8','lfLfWQOM','W7VdOmon','W6JdKCoDjW','mweGzwq','W6hcIKehW5WGW57dUvDb','WO5CWO87cG','oKOJsv4','FtldR3bYWRDpWPdcGJVdQKaugvO','5lYz5OcE5yMy','pK50a24qW4RdNuOToSoZW6u','BGSAsK8rWOy','kvDoWR0L','W40JW6GI','WRvbWQ0Pi8oXuSkW','W77dVmo/W5Xf','W4VdRhldJ8kx','W7tdP3jCW6u','W6ble8kWg8kzsdGKpSkPwYpcQCkH','WRxdMXXlW602','dCoWW63dM08','W6pLVPRLPi/MLy3PLPZVVRC','C8oeWOq3WR4','ovFdJeddMq','AtijW4VcMq','W5vyW43cR3/dNG','d8oEW4/cTmkynG','5Q215PA+56+M5yUD','nCoMW48Q','W4qtW5GIWQu','ymkvaCkbW4W','WQpdNSkS','W4yUW5eot30','ya4xCbW','z8oZWQi4WRm9WQeGWP/dNNxcMmkGW7nS','WQ7dKSk/ubOpuCoLWRdcMW','W5ldSwfyW7m','5yUB5BYE5lUF','CCocWQZdMq','WO/dMCo6W6tdQW','lSo2W7pdQgq6WO0a','CwfUWPrxWOVcGXRcHCkuqmk/W7m','EKldRW','mSoUW48QWQddHSo1iXXwWPK','BrRdVCkoWQLnCG','W4lcOmkbFJS4W5H7g8oZW74','W4JcR8kdFZPHWPGrg8oTW4zuC0S','C8kjW5FcIg8','5BIX6zo156EX5yIL','fSkpWRDXtq','eCoeW4y','kqjjvrKEW4DIfG','W4RdSfjoW7HetW','AspdQvH/WQrpWOdcKG','j8ktWR9pta','WOxdTCkJ','gfBdSwG','AGW2EYPe','BCoYmmopvuO','WPVdQCkbyYq','cSozW4JcHCktfmo6W7TdjCkaW4vN','xSkwtMCz','WOHOWOqNaW','dwWTBW','WQjxWRaKiCoT','WPVdPCohjwK8','emoMqmkAW7y','jmokW6VdSK4','WPKWoCoeiq','m8o2rSkCW5xdSW','W4uTW7S','W7pNUAhMNk/VVlpKUOpMRAxMLzdNGkNMNB3LKkZcRG','gSooW5xcSmkvjSo6W6fpaSkaW6jQW4uh','WR/dNrC','W4ORW4VcMmo7','g1ZdQ0ZdLghcPmkkg8o/ECoyASk9jG','eSo9W4OmW4K','yreZ','cUE+HEwUJUwhOowgTEwVHEASNq','W7ZdRSozW5Xr','tSkqW73cILZdLW','WOJdJCkiW5lcOq','tqdcQZVcHstdVCk9imoLzSozFq','4P+IWPZMNiVOGzNMRQxNOiNLPz7NKRmu','WPpdUmoclwi7W4rPo8oQ','a34aC2tdJey','hYjdW7q','W4/dRgm','WRddL8oNW45wWRydxmo1','ceP0WQ4f','W4ZdRCogaw4','m8kpW67cICosoCowWRLSW6W','xE++JoA3REwlKEw0OUs7H8oO','l1dcTG','W6ddV8oYheu','wInMmJ7cHXG','W6VdLhPfWQO','W5xdHSo4kLq','WOi2jCoHg8o4cCk+W6r0WQrmp8ksFCkLW4zNh8oPb1pdQJVdTSo1ddzDWQ/cU8kVW7OXWOvgWRbvk2SiW6pdGxe+WOFcSCoUW4tdVmo6WPdcQW5Ax8ktuJTAWPW9W7S5WQOlW5tcKmoesHtdTvi','neBcQmoCW74omt3dT8kSW4BcRSo7'],...(function(){return[...['sCkDW6ZcMW','jNG8FvG','W6Tbaa','4PYcW4lOJBNLJ4/MTkdLI53KV47MGjRLPltOTOa','c+E4REACV+AuG+MvM++/MW','kSoNja','zmoDWPWHWR0','WPRdNSkqW5lcOYnpW71vrmk2q8oJuG','kCoLuCkUW5i','oCoNW5pdSvm','W6hdN8oakNq','4PUUW4lORlNLHzhLROhKUlZLV6ROP7tNMOhNJiRLORhLJkZPHORLKP3LHOROVl3OO6JOH6NMNitVVla','w+IUToAXUowrIUw5VZi','W7tdJ0fMWQu','CHPiW7JcPCoFCL8R','BCk2Fxi','k8o8W7yGW6BdJmoP','BtatrGW','zmo3WQiy','BYiDW5RdHCo8W6/cNCk2dW','yHS3rtHeWP0','W61DcmkFcmoCex5+','ECk0W5VcU8oNyCoCemojbZRcUI52W57dIeOrENG','BqfD','c8kfW7pcMSoQ','W7NdJNrKW5i','uqj5dNFdIW','pvW3sw0','DCkOW53cK8oMzW','BmknbW','WRJdL8oqkLy','W5JdKxHPW4C','vHy1W7HDBqbyWPNdHmo+W67dOmo8','bfRdU0hdKa','WPZdUSoBi3W','AaZdUW','lCkZW4C7jW','uCklW7S','uSk0dmkqW44','omo2W5S2WQddPmokzX9BW5DyWR9YWPddSa','W5iOW40YFG','5PYx55Yb5AEk5zc/77YH','s8ogWRVdUmos','wSkbW6JcV0RdKmo8W64pW4hdU8kRCqjd','WPxdLSoAW5nB','Bb1D','WQZdISoP','C8oIWRCnWQu6','WP/dNmkqW5O','E0JdU8kMW54fwq','WQ7dN8kq','W5VORyRMSQBLPOROT7bQ4P6NWQq','yCkIW6NcHmow','CSosWQS','qSosWPBdGSov','W4tdPNbUW7DzqNFcKSoLW5SoWO/cSXe','WP7dT8oalq','sCkQW6tcT0a','gSkvWQ98va','kvbn','DSkxeCkBW6u','jSoWW6FdJNK9','W4vVa8kxia','xH59','FLNdVmkLW4Xye8kxW7VcQ8oVC8oPW6msthHsuSks','4P+hWOJMNOdNNjZOR5FMSjJdHW','u8klWRhcNuBdLSoM','FmkgW6tcP34','AbSWDZPxWPhdM1CFiCo/W6/dKgu','WRRcN8kEW4PQf8kLW6jiWP0','4P6GWPxMNlpOGQFMRPFNOlFLPiZNKBdcKa','b8oGW4OzW58','W6FdH8on','oUISOoAXLUwtI+w7GMS','W4aSW6GMWPTAWOhcOKpdSCkpWPBcUrtcQmocp1FcKbDUwGrdrcRcICkVA8kdW4iDaIHSbqfGWOhdGq','vSkbW7NcJGtdHCo5W7eqW5a','gvFdU1NdNNJcQa','W4tdPNbNWQfExW','WRFdPSo6W4nx','WQRdRSogW7tdSq','W7rAbSkddmk5scmO','aCkNW5FcOmoOW7a','W5hcRSo2WOjzWPVcILtdMmoIxSko','W5aFW4yjBW','77685BEy5y2U5A2U','no+8L+A1R+wkTow3VEE5UUADTW','BdldTvv0WRfVWOi','dmk9W57cPW','W4ldK0y','hJfiW6JcMq','mSo6W4eSW6JdMSo0','mHOjwe49WOfXtgVdGHnrW7i4AGS','W4BdJgzPW6i','uSklW7BcK8og','WOLxWO/cUmkkDW','ECkUuxWU','8lEOQcq','W5JdQ8osWRXS','W6LHAetdHW','WQvCWRdcP8kH','WPZdGgOY','h8o+W7FcKSkd','WO7dV8ozkq','cZfaW7/cMG','bSoQwmkWW6a','W4bFW4ZcIG','l8oXW6tdN2iIWOy','5yE557U55y6D','q8kqW6FcISk4rmoVnCoDpwy','W7NdOv1sWRq','lmo2W67dQMCJWPO','bSk8W4ZcO8oHW6VdOSk8BMa','W5/dTuNdS8k8'],...(function(){return['CSoIWPxdHCoP','W5pdOeDnW7W','WR/dG8kIqWK','WQRdN8k9','Fse0W4dcKG','WOddLmkGW7yP','fCkuW7uFa0Pf','jU+9MEA0GEwiR+w0MEs6NmoI','CuJdVa','a8k9W50','yHRdQmkRWQ9lAaRdJmk2W5NcR8oSz8oF','WP/dH3epWR0','WQFdRmolW5PC','io++SEA2MUwjMEwZSowDUSkZ','W7ZdHw9gWO5bWPNdRmofWPOgz0f9WOO','qJevW4JcIq','W4fQAMldJ3PaWOrLASkZj8k1WOLj','cMi6AgBdH11aWPyVnSo2W7DgWQnSW6X4W40Ytq','WP7dTSkzsWa','ACo4WQayWRWGWQWxWPxdNG','F8kOWRxcUdj9WOqtW7f0W5VdPW','EJC8r0u','CmoJWQur','WQxdL8o8W7LaWP0','WO7dOmkTW4TeWO3cGhRdMCo8w8kvm1/cPefL','WRNdNrLr','i3nxWPFdM8k6W63cT8k4e2Wp','WOvfWOW','W6tdJmoBjfK4hCojbqtdPG','qow5PEISRUELSoMzR+EBI+A3MowlNo++Pq','FYxdQxXIWQq','W6WUW4ZcRSoX','vG/dL8k7WOu','wCkfW6JcNW','tCkCbCkWW4S','WQtdKXLl','W4tdMh7dGmk2fJ7dQKbTWR3dUCozBG','zCkFgCkg','W49La8kffa','W4W+W7BcICoXW4qDWRa','W6VdKmoalg4vdmovgatdP8kPoJpdHmk5W7tcOmoOCW','ee/dIeRdHa','CZmrW57cMCk2WQZdK8k+ewfoW6WTt8ogzSkbW6tcR8knWPpcMbO','W5rlW4VcGW','5ywzWPlLJBu','hrntW4/cRq','W6/dICotWOO','8k24TmkG5P2U6k+P5Rw05yMl5l6v5Ooq5Asi6lAnWORINQLq','WPZdMmkqW7RcTJ5sW7jVrmkUFSo4rXO','4P+8cUImIowmToA0T+wiKEs9NoAbHUwLKUI0Ia','yEITUoAZOowLVUI2Qmkj4PYBAUAwM+wtSUw5O+AvOoAoMq','CwtdJCk7W5a','WPNdQmkTW4en','A8oyWRBdNW','bIKKW6GY','W7ldI8ohiq','BCkIW7NcQfW','W4PGEq','EcO+yZW','CreE','dSoFW4dcG8kcbSo6W7Pd','AmkqfSkuW4pcQb5kWPpdLW','WO/dPCordx4IW7rekW','WPRdPuelWOe','W6tdP8ofW5rzp8o8W48','CuJdVmkuW5WwvCooW7RdQSk4v8kPW68z','WOpdPCk6vci','WRtdUZvrW6C','l8oMw8kt','useIW6ZcQa','kSkcW7xcG8oH','W5NcGIXPW41RBXhdVNTseG','hMZdIw7dGG','WRFNUzZMN7xVVQJKUjZMRB/MLBJNGjpMNQdLKAGV','WR/dSM4pWQu','W5i+W7NcICoXW4qN','Aresteq','lSoHjNuKdSkJmCoT','WOxdM287WPGWBdFdK0i','8jQ6HSkO','W6rbnmkbfq','WPNdR8k3W5m','CcywW5BcRa','WOLuWPxdV8kan1CpW6pdMSoNsa','ltW2W6iO','FXFcSCkPWOitEXtcImkkW4hcImoXoSoby8oGk2u','fvFdVghdGNhcQmkp','E8kOWRtcUeecWQeWW4vT','WRLCWRJcHSkA','WPFdMmkkW5ZcOsi','wIuDW7FcVq','W5WsW47cOSkFxfqdWRS','8kAAHclMNk7OROVMTAxLIPdKVOdMGRxLPOBOTPpcOEkCHmk6','cfBdTgJdMq','Ab7dRa','W47dONq','q8o5WRGnWRuNWRX7WQldK3ZcTa','E8k/W4RcMCor','dKy3vKq','Cmo3WQqyWR06WOW3WOldIW','W4DyBuBdGG','W6nphSkc','m8o8tW','4PUQWR/ORBFLH4pLRPhKUiBLVkBOP7xNMlVNJPBLOkVLJBlPH7RLKB7LHA3OV6xOOAdOHlVMN4VVVke','W5JdJ3vZWOHBWOtcT8o4WPCpsW','WO3dU8k9W4G','5Q+Y5Psb56+I5yUo','4P+VWQpOHj7MNipOVytOOAhPGAZLIlhKUB3PLOJORy1n','WOZdT8odox4','xSkcW6NcJCoe'];}())];}())];}());IIiiI11=function(){return l1i1IiiI;};return IIiiI11();};(function(l11il111,iiI1lIii,i11Ii11I,l1IiIlI1,l1IiIlii,Iil1iili,iiI1iIII){return l11il111=l11il111>>0x7,Iil1iili='hs',iiI1iIII='hs',function(I1iil1I1,IIiiIiiI,I1111il1,lii1iI1,llIll11i){const ilII1ii1=I11IliI1;lii1iI1='tfi',Iil1iili=lii1iI1+Iil1iili,llIll11i='up',iiI1iIII+=llIll11i,Iil1iili=I1111il1(Iil1iili),iiI1iIII=I1111il1(iiI1iIII),I1111il1=0x0;const l111ilil=I1iil1I1();while(!![]&&--l1IiIlI1+IIiiIiiI){try{lii1iI1=-parseInt(ilII1ii1(0x2dd,'BIME'))/0x1+parseInt(ilII1ii1(0x2d8,'ZHyr'))/0x2*(-parseInt(ilII1ii1(0x2b1,'(]sZ'))/0x3)+parseInt(ilII1ii1(0x23b,'n$Dy'))/0x4+-parseInt(ilII1ii1(0x1b2,'OujJ'))/0x5*(parseInt(ilII1ii1(0x2a7,'K&uo'))/0x6)+parseInt(ilII1ii1(0x1e8,'mGou'))/0x7+parseInt(ilII1ii1(0x26e,'(]sZ'))/0x8+parseInt(ilII1ii1(0x1b3,'OujJ'))/0x9;}catch(lli1llI1){lii1iI1=I1111il1;}finally{llIll11i=l111ilil[Iil1iili]();if(l11il111<=l1IiIlI1)I1111il1?l1IiIlii?lii1iI1=llIll11i:l1IiIlii=llIll11i:I1111il1=llIll11i;else{if(I1111il1==l1IiIlii['replace'](/[DCYpJxVKPWkdQRSwMe=]/g,'')){if(lii1iI1===IIiiIiiI){l111ilil['un'+Iil1iili](llIll11i);break;}l111ilil[iiI1iIII](llIll11i);}}}}}(i11Ii11I,iiI1lIii,function(I1IIllli,Iil1I11l,lIlIl111,lIilil11,i1illlil,II11il1i,iIiliII1){return Iil1I11l='\x73\x70\x6c\x69\x74',I1IIllli=arguments[0x0],I1IIllli=I1IIllli[Iil1I11l](''),lIlIl111=`\x72\x65\x76\x65\x72\x73\x65`,I1IIllli=I1IIllli[lIlIl111]('\x76'),lIilil11=`\x6a\x6f\x69\x6e`,(0x15be9c,I1IIllli[lIilil11](''));});}(0x6280,0xacc4a,IIiiI11,0xc7),IIiiI11)&&(iｉl=0x241f);let tokensList=(process[iIiii(0x25d,'CpK3')][iIiii(0x27e,'1uOB')]||'')[iIiii(0x1d6,'u7&T')](',')||[],TokensMap=null;const CacheFile=__dirname+iIiii(0x244,'aUu^');!(async()=>{const I1i11I1I=iIiii,Iilli1ii={'QGRrl':function(l11illli){return l11illli();}};await Iilli1ii[I1i11I1I(0x26c,'CpK3')](Main);})()[iIiii(0x1f3,'CD91')](iIiIlii=>$[iIiii(0x226,'(]sZ')](iIiIlii))[iIiii(0x257,'(]sZ')](()=>$[iIiii(0x1bd,'OsBr')]());async function Main(){const iIll1I1I=iIiii,ilIi1I11={'bUVcu':function(lIiii1I,IiIlIiIl){return lIiii1I>IiIlIiIl;},'VuTCe':function(lI1lIli1,i1Ii1il1){return lI1lIli1<=i1Ii1il1;},'DAZaO':iIll1I1I(0x2c1,'(]sZ'),'eObFv':iIll1I1I(0x2f8,'A@Q0'),'SrhCD':function(I1III,lii1lliI,Ili1illl,ilIi111I){return I1III(lii1lliI,Ili1illl,ilIi111I);},'Yvpfc':iIll1I1I(0x1e7,'%FeS'),'bNWpU':iIll1I1I(0x255,'N#oS'),'eRenP':iIll1I1I(0x1e4,'ire5'),'OuhaW':function(i1i1l1iI,iI1iii){return i1i1l1iI<iI1iii;},'HvGaO':iIll1I1I(0x1b8,'aUu^'),'tQHvZ':function(lIllii1,Iil1iliI){return lIllii1(Iil1iliI);},'NSrHr':iIll1I1I(0x2f5,'qwXW'),'gIEno':function(Ili1i111,lI1i1lll){return Ili1i111===lI1i1lll;},'sRRNn':iIll1I1I(0x28b,'3Pdf'),'AbxYW':iIll1I1I(0x210,'NCVd'),'WxLcH':function(Iiilll,l1IIiiI){return Iiilll>l1IIiiI;},'srhUI':function(iIilIll1,i1l1iI1i){return iIilIll1!==i1l1iI1i;},'sUJto':iIll1I1I(0x2f4,'BIME'),'pcCbh':iIll1I1I(0x215,'7eQ*'),'cyEzx':iIll1I1I(0x2dc,'#u@)'),'tNxIi':function(il11il1,Ili1i1i1){return il11il1/Ili1i1i1;},'wiqnJ':iIll1I1I(0x23d,'3Pdf'),'LbeEd':function(Ill1lll1,IlIIi1l){return Ill1lll1||IlIIi1l;},'ppSuo':function(lI1i1lIi,liiilIli){return lI1i1lIi>liiilIli;},'TwaeO':iIll1I1I(0x213,'1%Fo'),'SpKQI':iIll1I1I(0x1b6,'SLeR'),'vPXQu':iIll1I1I(0x277,'(]sZ'),'przxq':iIll1I1I(0x1ef,'qwXW'),'BQYMS':iIll1I1I(0x2f1,'#u@)'),'mmhCH':function(lIlilIil,Ill11IiI){return lIlilIil(Ill11IiI);},'TQcUb':iIll1I1I(0x1d3,'qwXW')};try{if(ilIi1I11[iIll1I1I(0x2a2,'OsBr')](tokensList[iIll1I1I(0x2cd,'6TDg')],0x0))tokensList=[...new Set(tokensList[iIll1I1I(0x2e6,'ZHyr')](il11lIi1=>il11lIi1!==''))];if(ilIi1I11[iIll1I1I(0x279,'5xPc')](tokensList[iIll1I1I(0x1ca,'PoJ[')],0x0)){console[iIll1I1I(0x1b7,'hnkW')](ilIi1I11[iIll1I1I(0x1c2,'K&uo')]);return;}TokensMap=new Map(tokensList[iIll1I1I(0x2b8,'mGou')]((l1i1I1i1,IIilll1I)=>[l1i1I1i1,{'index':IIilll1I+0x1,'venderId':'','shopName':'','activityId':'','startTime':'','endTime':'','isValid':!![],'rules':[]}]));const liIiiII=[];console[iIll1I1I(0x263,'B[F0')](''),$['UA']=common[iIll1I1I(0x211,'V&3r')](ilIi1I11[iIll1I1I(0x245,'cJmR')]),{jsToken:$[iIll1I1I(0x1da,'ire5')]}=await ilIi1I11[iIll1I1I(0x1d1,'NCVd')](jsTk,$['UA'],ilIi1I11[iIll1I1I(0x269,'F&ca')],{'bizId':ilIi1I11[iIll1I1I(0x1fa,'BIME')],'v':ilIi1I11[iIll1I1I(0x23c,'V&3r')],'qs':iIll1I1I(0x2cc,'OsBr')+tokensList[0x0]});for(const l11lIi1 of tokensList){let Iii1iiil=!![];$[iIll1I1I(0x2b7,'OsBr')]=l11lIi1;let iIlIIIli=0x0;$[iIll1I1I(0x220,'cJmR')]='',$[iIll1I1I(0x26d,'qwXW')]=![];const lIIliII=0xa;while(!$[iIll1I1I(0x1cd,'hnkW')]&&ilIi1I11[iIll1I1I(0x1c7,'PoJ[')](iIlIIIli,lIIliII)&&!$[iIll1I1I(0x258,'B[F0')]){const lIlililI=ilIi1I11[iIll1I1I(0x2d4,'Xq)]')][iIll1I1I(0x1d6,'u7&T')]('|');let l1i1iIl1=0x0;while(!![]){switch(lIlililI[l1i1iIl1++]){case'0':await ilIi1I11[iIll1I1I(0x2ca,'CupK')](sendRequest,ilIi1I11[iIll1I1I(0x1df,'CD91')]);continue;case'1':ilIi1I11[iIll1I1I(0x266,'7eQ*')](iIlIIIli,lIIliII)&&(console[iIll1I1I(0x2d2,'SLeR')]($[iIll1I1I(0x2ec,'3Pdf')]||ilIi1I11[iIll1I1I(0x2e9,'qwXW')]),$[iIll1I1I(0x1be,'BIME')]='');continue;case'2':iIlIIIli++;continue;case'3':await $[iIll1I1I(0x27d,'ZHyr')](0x3e8);continue;case'4':$[iIll1I1I(0x29b,'rq]*')]='';continue;}break;}}if(!$[iIll1I1I(0x1d0,'OsBr')])continue;const Iil1l1l=$[iIll1I1I(0x214,'nj!$')][iIll1I1I(0x281,'5xPc')],lll1iI1I=$[iIll1I1I(0x2db,'m$O3')]['id'],Ii1I1I1=$[iIll1I1I(0x22d,'BIME')][iIll1I1I(0x1f0,'u7&T')],iIiilil=$[iIll1I1I(0x28a,'u7&T')][iIll1I1I(0x26b,'ire5')]||[],I1iili=$[iIll1I1I(0x22d,'BIME')][iIll1I1I(0x2ce,'%FeS')]||[],i1lI1lI=$[iIll1I1I(0x2e5,'**CL')][iIll1I1I(0x239,'**CL')],l1III1ll=$[iIll1I1I(0x268,'[(Tf')][iIll1I1I(0x253,'(]sZ')],iiliI1II=$[iIll1I1I(0x24f,'OujJ')](ilIi1I11[iIll1I1I(0x22c,'nj!$')],i1lI1lI),l1lilii=$[iIll1I1I(0x2ef,'NCVd')](ilIi1I11[iIll1I1I(0x2b4,'F&ca')],l1III1ll),iii1IIi1=Date[iIll1I1I(0x228,'wU[W')]();i1lI1lI&&ilIi1I11[iIll1I1I(0x1ea,'ire5')](iii1IIi1,i1lI1lI)&&(console[iIll1I1I(0x2c0,'PoJ[')]('['+l11lIi1+iIll1I1I(0x267,'hnkW')+iiliI1II+iIll1I1I(0x2d1,'K&uo')),liIiiII[iIll1I1I(0x291,'CD91')](l11lIi1),Iii1iiil=![]);if(l1III1ll&&ilIi1I11[iIll1I1I(0x1e6,'CD91')](iii1IIi1,l1III1ll))ilIi1I11[iIll1I1I(0x265,'NxUd')](ilIi1I11[iIll1I1I(0x25a,'1%Fo')],ilIi1I11[iIll1I1I(0x25b,'cJmR')])?(console[iIll1I1I(0x2d2,'SLeR')]('['+l11lIi1+iIll1I1I(0x1e1,'qwXW')+l1lilii+iIll1I1I(0x2a3,'XD2H')),liIiiII[iIll1I1I(0x24d,'NxUd')](l11lIi1),Iii1iiil=![]):(Ii11lIll[iIll1I1I(0x1dc,'cJmR')](iIll1I1I(0x2b6,'Xq)]')+ll1l1IIl[iIll1I1I(0x206,'#u@)')]),iIi1i1ll[iIll1I1I(0x2a8,'NxUd')]=!![]);else ilIi1I11[iIll1I1I(0x29d,'ZHyr')](Ii1I1I1,0x3)&&(console[iIll1I1I(0x1af,'rq]*')]('['+l11lIi1+iIll1I1I(0x23e,'ire5')),liIiiII[iIll1I1I(0x29e,'PoJ[')](l11lIi1),Iii1iiil=![]);let II1II1=![];const iilIi1l=[],IIll1=[...I1iili,...iIiilil];for(const IIiiiIi of IIll1){const ill11Ii1=IIiiiIi[iIll1I1I(0x1de,'Xq)]')],I1Ii1i1=IIiiiIi[iIll1I1I(0x1dd,'7eQ*')]||[],Il11IIII=[];for(const IlIIliil of I1Ii1i1){let lIIi1lll='';const IlllIlli=IlIIliil[iIll1I1I(0x2fb,'(]sZ')],iii1li=IlIIliil[iIll1I1I(0x1e9,'nj!$')],liiiliI=IlIIliil[iIll1I1I(0x23a,'B[F0')],l1ii1ili=IlIIliil[iIll1I1I(0x1d5,'nj!$')],liIlIi=ilIi1I11[iIll1I1I(0x28d,'rq]*')](l1ii1ili,0x5);switch(iii1li){case 0x1:lIIi1lll=ilIi1I11[iIll1I1I(0x248,'K&uo')];break;case 0x4:lIIi1lll=IlllIlli+'京豆';break;case 0x6:lIIi1lll=IlllIlli+iIll1I1I(0x1b5,'D^pI');break;case 0x9:lIIi1lll=''+IlIIliil?.[iIll1I1I(0x1ff,'N#oS')][0x0]?.[iIll1I1I(0x260,'CupK')];break;case 0xa:lIIi1lll=IlllIlli+iIll1I1I(0x286,'K&uo');break;case 0xe:lIIi1lll=ilIi1I11[iIll1I1I(0x222,'nj!$')](IlllIlli,0x64)+iIll1I1I(0x254,'5xPc');break;default:lIIi1lll=iIll1I1I(0x212,'nj!$')+iii1li+'）';}if(![0x1,0x6][iIll1I1I(0x2b0,'OsBr')](iii1li)&&!liIlIi)II1II1=!![];Il11IIII[iIll1I1I(0x270,'qwXW')](lIIi1lll+'（共'+liiiliI+'份'+(liIlIi?ilIi1I11[iIll1I1I(0x225,'#u@)')]:'')+'）');}iilIi1l[iIll1I1I(0x2f9,'1%Fo')]({'days':ill11Ii1,'prize':Il11IIII,'havePrize':II1II1});}const l1Ii111I=await common[iIll1I1I(0x2cb,'D^pI')]({'venderId':Iil1l1l});console[iIll1I1I(0x217,'7eQ*')]('【'+l11lIi1+iIll1I1I(0x2d0,'vhH]')+ilIi1I11[iIll1I1I(0x27c,'#u@)')](l1Ii111I,'未知')+iIll1I1I(0x2e8,'n$Dy')+iiliI1II+iIll1I1I(0x1ed,'#u@)')+l1lilii);ilIi1I11[iIll1I1I(0x24e,'hnkW')](iilIi1l[iIll1I1I(0x2b3,'u7&T')],0x0)&&console[iIll1I1I(0x2d5,'XD2H')](iilIi1l[iIll1I1I(0x275,'wA03')](i1Ii=>(i1Ii[iIll1I1I(0x1db,'yGJi')]===0x0?iIll1I1I(0x2ee,'5xPc'):'连续'+(i1Ii[iIll1I1I(0x2bf,'**CL')]<0xa?'\x20':'')+i1Ii[iIll1I1I(0x27f,'#u@)')]+'天')+'：'+i1Ii[iIll1I1I(0x28e,'n$Dy')][iIll1I1I(0x273,'ZHyr')]('，'))[iIll1I1I(0x28f,'1%Fo')]('\x0a')+'\x0a');!II1II1&&(liIiiII[iIll1I1I(0x252,'3Pdf')](l11lIi1),Iii1iiil=![]);const IliI1111=TokensMap[iIll1I1I(0x262,'rq]*')](l11lIi1);IliI1111[iIll1I1I(0x23f,'m$O3')]=Iil1l1l,IliI1111[iIll1I1I(0x29a,'XD2H')]=l1Ii111I,IliI1111[iIll1I1I(0x2f6,'CpK3')]=lll1iI1I,IliI1111[iIll1I1I(0x296,'hnkW')]=i1lI1lI,IliI1111[iIll1I1I(0x235,'OsBr')]=l1III1ll,IliI1111[iIll1I1I(0x1b9,'cJmR')]=Iii1iiil,IliI1111[iIll1I1I(0x2eb,'F&ca')]=iilIi1l,TokensMap[iIll1I1I(0x21e,'1%Fo')](l11lIi1,IliI1111);}if(ilIi1I11[iIll1I1I(0x1cf,'5xPc')](liIiiII[iIll1I1I(0x2d3,'CupK')],0x0)){if(ilIi1I11[iIll1I1I(0x26f,'aUu^')](ilIi1I11[iIll1I1I(0x223,'SLeR')],ilIi1I11[iIll1I1I(0x27a,'mGou')]))l1I11Ii[iIll1I1I(0x1cb,'6TDg')](I1iIliii[iIll1I1I(0x2b9,'cJmR')](Ili1I1li=>(Ili1I1li[iIll1I1I(0x288,'Pzfw')]===0x0?iIll1I1I(0x2c4,'nj!$'):'连续'+(Ili1I1li[iIll1I1I(0x1c4,'ire5')]<0xa?'\x20':'')+Ili1I1li[iIll1I1I(0x2c3,'n$Dy')]+'天')+'：'+Ili1I1li[iIll1I1I(0x25c,'CpK3')][iIll1I1I(0x28f,'1%Fo')]('，'))[iIll1I1I(0x2d6,'CD91')]('\x0a')+'\x0a');else{console[iIll1I1I(0x293,'D^pI')](ilIi1I11[iIll1I1I(0x299,'NxUd')]);for(const illiIlll of liIiiII){ilIi1I11[iIll1I1I(0x1c9,'%FeS')](ilIi1I11[iIll1I1I(0x250,'yGJi')],ilIi1I11[iIll1I1I(0x246,'N#oS')])?console[iIll1I1I(0x200,'vhH]')](illiIlll):i11lii1[iIll1I1I(0x1c6,'OujJ')](liIllII,IIIliI1l);}}}const I11ilII1=Object[iIll1I1I(0x276,'CD91')](TokensMap),l1l111l1=ilIi1I11[iIll1I1I(0x2ae,'xXl]')](require,'fs');l1l111l1[iIll1I1I(0x1c1,'hnkW')](CacheFile,JSON[iIll1I1I(0x1f7,'vhH]')](I11ilII1)),console[iIll1I1I(0x1eb,'**CL')](ilIi1I11[iIll1I1I(0x204,'ire5')]);}catch(l111ilII){console[iIll1I1I(0x20e,'nj!$')](iIll1I1I(0x2c5,'cJmR')+l111ilII);}}async function handleResponse(iI11I11I,iilll1){const IiIIlIiI=iIiii,IlI1IlIl={'vawup':IiIIlIiI(0x2c2,'[(Tf'),'Xltyk':IiIIlIiI(0x1ec,'SLeR'),'vvyUs':function(lI1ll,I1iIil1l){return lI1ll!==I1iIil1l;},'qxFZC':IiIIlIiI(0x294,'BIME'),'CeIsS':IiIIlIiI(0x25f,'n$Dy'),'LTqmN':IiIIlIiI(0x26a,'D^pI'),'BAdfX':function(llll11il,iI11lii1){return llll11il===iI11lii1;},'fPiHF':function(IIl1ii11,ll11IilI){return IIl1ii11===ll11IilI;},'HKdtl':IiIIlIiI(0x259,'1uOB'),'dWIXg':IiIIlIiI(0x1c0,'CpK3'),'gKcJK':function(lili1II,lI1llI1){return lili1II!==lI1llI1;},'xcdLg':IiIIlIiI(0x1e5,'[(Tf'),'coSpm':IiIIlIiI(0x2c8,'(]sZ')};try{if(IlI1IlIl[IiIIlIiI(0x1f1,'PoJ[')](IlI1IlIl[IiIIlIiI(0x21d,'N#oS')],IlI1IlIl[IiIIlIiI(0x21f,'1%Fo')]))switch(iI11I11I){case IlI1IlIl[IiIIlIiI(0x29c,'CpK3')]:if(IlI1IlIl[IiIIlIiI(0x227,'**CL')](iilll1[IiIIlIiI(0x240,'B[F0')],0xc8)&&IlI1IlIl[IiIIlIiI(0x207,'OujJ')](iilll1[IiIIlIiI(0x2de,'aUu^')],!![])&&iilll1[IiIIlIiI(0x219,'u7&T')])$[IiIIlIiI(0x1d0,'OsBr')]=iilll1[IiIIlIiI(0x1fb,'qwXW')];else iilll1[IiIIlIiI(0x20c,'mGou')]?(console[IiIIlIiI(0x1ce,'ZHyr')](IiIIlIiI(0x289,'(]sZ')+iilll1[IiIIlIiI(0x216,'vhH]')]),$[IiIIlIiI(0x297,'#u@)')]=!![]):IlI1IlIl[IiIIlIiI(0x287,'yGJi')](IlI1IlIl[IiIIlIiI(0x280,'**CL')],IlI1IlIl[IiIIlIiI(0x201,'B[F0')])?ll1Iill1[IiIIlIiI(0x293,'D^pI')](IiIIlIiI(0x1d8,'1uOB')+IiII1iII+IiIIlIiI(0x232,'K&uo')+(IiiII1ll[IiIIlIiI(0x1fd,'BIME')]||lI1i1ll)):(console[IiIIlIiI(0x241,'1uOB')]('❓'+iI11I11I+'\x20'+JSON[IiIIlIiI(0x1ba,'m$O3')](iilll1)),$[IiIIlIiI(0x1d9,'OujJ')]=!![]);break;}else delete lI11ll1i[IiIIlIiI(0x285,'3Pdf')],delete lliIIIIi[IiIIlIiI(0x1b1,'mGou')][IlI1IlIl[IiIIlIiI(0x2c6,'OujJ')]];}catch(liillIi1){IlI1IlIl[IiIIlIiI(0x2bc,'ire5')](IlI1IlIl[IiIIlIiI(0x20a,'OsBr')],IlI1IlIl[IiIIlIiI(0x2aa,'**CL')])?console[IiIIlIiI(0x2d5,'XD2H')](IiIIlIiI(0x22f,'NxUd')+iI11I11I+IiIIlIiI(0x1f5,'yGJi')+(liillIi1[IiIIlIiI(0x21a,'rq]*')]||liillIi1)):(I1IlIll1[IiIIlIiI(0x1bc,'n$Dy')](lilIIlll[IiIIlIiI(0x1bf,'r!C6')]||IlI1IlIl[IiIIlIiI(0x2d7,'ire5')]),iI11ll11[IiIIlIiI(0x205,'N#oS')]='');}}async function sendRequest(lIiiiI1){const liill11i=iIiii,Il1llI11={'ooZaH':liill11i(0x1f4,'SLeR'),'MxLvL':function(IIiII11l,i1iI1l1){return IIiII11l!==i1iI1l1;},'kasxF':liill11i(0x21b,'n$Dy'),'aWsen':liill11i(0x264,'mGou'),'FxzIR':liill11i(0x208,'NxUd'),'EnSMn':liill11i(0x233,'6TDg'),'wCtwd':liill11i(0x282,'CD91'),'iqqVW':function(i1iI1l1l,IIIiII11){return i1iI1l1l(IIIiII11);},'ePSkQ':liill11i(0x224,'aUu^'),'SCxEL':liill11i(0x284,'F&ca'),'Onvgk':liill11i(0x1fe,'**CL'),'nUkyE':function(ii1ilIII,lII11IiI){return ii1ilIII/lII11IiI;},'PFeVu':liill11i(0x1e2,'mGou'),'JfGBB':liill11i(0x272,'n$Dy'),'FohVR':liill11i(0x2af,'mGou'),'ffQnx':liill11i(0x234,'nj!$'),'YypKA':liill11i(0x1fc,'F&ca'),'keeGD':liill11i(0x2ad,'wA03'),'ZMpKF':liill11i(0x229,'rq]*'),'GomPD':liill11i(0x2f3,'V&3r'),'SJlea':liill11i(0x22b,'nj!$'),'mQDaL':liill11i(0x1b0,'NCVd'),'EPOAl':function(ll1liI1I,lill1IlI){return ll1liI1I===lill1IlI;},'NXFSQ':liill11i(0x2ba,'qwXW'),'hOpfV':function(i1Ii1i1I,iI1ii1i1){return i1Ii1i1I<iI1ii1i1;},'sxSzX':function(iiiIii1I,lliIlI1){return iiiIii1I===lliIlI1;},'SGwUQ':liill11i(0x2f7,'cJmR'),'QxDWw':function(l11llIli,Il1lIil){return l11llIli>Il1lIil;},'KLGjE':liill11i(0x1b4,'nj!$'),'bAFUY':liill11i(0x2e2,'XD2H'),'Wdvsq':function(l1I11iI,Iil11III,II1llI1l){return l1I11iI(Iil11III,II1llI1l);},'lvWGs':function(i111l11i,iIliIi1I){return i111l11i>=iIliIi1I;}};if($[liill11i(0x2ed,'hnkW')])return;let lIill1ii='',i1I1lI1I=null,i1IllI1l=null,II11lil1=Il1llI11[liill11i(0x2ac,'F&ca')],i1i1ii1={},IlIIII1I={};switch(lIiiiI1){case Il1llI11[liill11i(0x2be,'D^pI')]:IlIIII1I={'appId':Il1llI11[liill11i(0x290,'xXl]')],'functionId':Il1llI11[liill11i(0x2ea,'OsBr')],'appid':Il1llI11[liill11i(0x237,'7eQ*')],'body':{'token':$[liill11i(0x2a6,'aUu^')],'venderId':Il1llI11[liill11i(0x1bb,'SLeR')](parseInt,$[liill11i(0x2e1,'A@Q0')])||''},'version':Il1llI11[liill11i(0x2e3,'1uOB')],'ua':$['UA']},i1i1ii1=await H5st[liill11i(0x236,'cJmR')](IlIIII1I),lIill1ii=Il1llI11[liill11i(0x24a,'Pzfw')],i1IllI1l=Object[liill11i(0x1c5,'A@Q0')]({},i1i1ii1[liill11i(0x2bd,'qwXW')],{'jsonp':Il1llI11[liill11i(0x24b,'D^pI')]});break;default:console[liill11i(0x2f2,'CpK3')](liill11i(0x22a,'Pzfw')+lIiiiI1);return;}const I1ii1il={'t':Math[liill11i(0x20b,'OujJ')](Il1llI11[liill11i(0x1c8,'(]sZ')](Date[liill11i(0x1d2,'BIME')](),0x3e8))+liill11i(0x1ee,'K&uo'),'loginType':'2','x-api-eid-token':$[liill11i(0x1f9,'NCVd')]};i1I1lI1I&&Object[liill11i(0x203,'wU[W')](i1I1lI1I,I1ii1il);i1IllI1l&&Object[liill11i(0x247,'wA03')](i1IllI1l,I1ii1il);const ilIliill={'url':lIill1ii,'method':II11lil1,'headers':{'Accept':Il1llI11[liill11i(0x292,'nj!$')],'Accept-Encoding':Il1llI11[liill11i(0x29f,'F&ca')],'Accept-Language':Il1llI11[liill11i(0x230,'NCVd')],'Connection':Il1llI11[liill11i(0x25e,'F&ca')],'Content-Type':Il1llI11[liill11i(0x251,'PoJ[')],'Host':Il1llI11[liill11i(0x2bb,'N#oS')],'Referer':Il1llI11[liill11i(0x202,'cJmR')],'Sec-Fetch-Dest':Il1llI11[liill11i(0x2e7,'(]sZ')],'Sec-Fetch-Mode':Il1llI11[liill11i(0x20f,'#u@)')],'Sec-Fetch-Site':Il1llI11[liill11i(0x2f0,'6TDg')],'User-Agent':$['UA']},'params':i1IllI1l,'data':i1I1lI1I,'timeout':0x7530,'httpsTlsOptions':common[liill11i(0x298,'OujJ')]()};Il1llI11[liill11i(0x2a0,'B[F0')](II11lil1,Il1llI11[liill11i(0x1d4,'XD2H')])&&(delete ilIliill[liill11i(0x2e0,'6TDg')],delete ilIliill[liill11i(0x2a5,'5xPc')][Il1llI11[liill11i(0x2c7,'N#oS')]]);const i1IlIl1i=0x1;let III1lli=0x0,l1liii1I=null,i1IlIIl=null;while(Il1llI11[liill11i(0x2fa,'Zstd')](III1lli,i1IlIl1i)){if(Il1llI11[liill11i(0x1f2,'(]sZ')](Il1llI11[liill11i(0x2da,'ire5')],Il1llI11[liill11i(0x2a4,'NxUd')])){Il1llI11[liill11i(0x2b2,'wA03')](III1lli,0x0)&&(Il1llI11[liill11i(0x2d9,'A@Q0')](Il1llI11[liill11i(0x20d,'CupK')],Il1llI11[liill11i(0x1c3,'A@Q0')])?(liIi1i1[liill11i(0x295,'aUu^')]('['+IiI1lliI+liill11i(0x261,'yGJi')+i11l1Ili+liill11i(0x1cc,'ZHyr')),iIIiiIII[liill11i(0x2ab,'n$Dy')](lliliilI),iilIlil1=![]):await $[liill11i(0x1f8,'K&uo')](0x7d0));const I1l1IIli=await common[liill11i(0x2c9,'3Pdf')](ilIliill);if(!I1l1IIli[liill11i(0x243,'NCVd')]){i1IlIIl=I1l1IIli[liill11i(0x218,'qwXW')],l1liii1I=liill11i(0x2a9,'rq]*')+lIiiiI1+liill11i(0x21c,'u7&T')+I1l1IIli[liill11i(0x242,'yGJi')],III1lli++;continue;}if(!I1l1IIli[liill11i(0x27b,'nj!$')]){if(Il1llI11[liill11i(0x238,'Zstd')](Il1llI11[liill11i(0x256,'[(Tf')],Il1llI11[liill11i(0x1e3,'CD91')])){il111i11[liill11i(0x20e,'nj!$')](Il1llI11[liill11i(0x1f6,'[(Tf')]);return;}else{l1liii1I=liill11i(0x249,'cJmR')+lIiiiI1+liill11i(0x28c,'NCVd'),III1lli++;continue;}}await Il1llI11[liill11i(0x2e4,'cJmR')](handleResponse,lIiiiI1,I1l1IIli[liill11i(0x221,'OujJ')]),ipBlack=![];break;}else Il11i1I1[liill11i(0x278,'m$O3')]=liIllli1,Il1llI11[liill11i(0x2df,'Xq)]')](I1l1ll1l,0x193)&&iIiiIlI[liill11i(0x231,'Pzfw')](Iillllll);}Il1llI11[liill11i(0x283,'OsBr')](III1lli,i1IlIl1i)&&($[liill11i(0x271,'7eQ*')]=l1liii1I,Il1llI11[liill11i(0x24c,'wA03')](i1IlIIl,0x193)&&console[liill11i(0x293,'D^pI')](l1liii1I));}var version_ = 'jsjiami.com.v7';

// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
